<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>How YOU can build a Serverless C# .Net Core API in no time, with bindings and a Database</title>
    <meta name="description" content="[object Object]">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.ef15c391.css" as="style"><link rel="preload" href="/assets/js/app.4ba00308.js" as="script"><link rel="preload" href="/assets/js/9.454b5262.js" as="script"><link rel="preload" href="/assets/js/4.eac68367.js" as="script"><link rel="preload" href="/assets/js/125.76dfd28a.js" as="script"><link rel="prefetch" href="/assets/js/1.36663999.js"><link rel="prefetch" href="/assets/js/10.dece7075.js"><link rel="prefetch" href="/assets/js/100.40076a18.js"><link rel="prefetch" href="/assets/js/101.40dbea08.js"><link rel="prefetch" href="/assets/js/102.d2f346e2.js"><link rel="prefetch" href="/assets/js/103.baf870fb.js"><link rel="prefetch" href="/assets/js/104.284a8d9c.js"><link rel="prefetch" href="/assets/js/105.85ce7f52.js"><link rel="prefetch" href="/assets/js/106.64bade78.js"><link rel="prefetch" href="/assets/js/107.93610e3a.js"><link rel="prefetch" href="/assets/js/108.a6a60bba.js"><link rel="prefetch" href="/assets/js/109.1b2b2d4a.js"><link rel="prefetch" href="/assets/js/11.a104adc8.js"><link rel="prefetch" href="/assets/js/110.aef9a48e.js"><link rel="prefetch" href="/assets/js/111.68a42b05.js"><link rel="prefetch" href="/assets/js/112.fa5040a3.js"><link rel="prefetch" href="/assets/js/113.4520768e.js"><link rel="prefetch" href="/assets/js/114.004ad6e8.js"><link rel="prefetch" href="/assets/js/115.a34b9c20.js"><link rel="prefetch" href="/assets/js/116.ca9ecd6e.js"><link rel="prefetch" href="/assets/js/117.e41be6b7.js"><link rel="prefetch" href="/assets/js/118.7c0fef0a.js"><link rel="prefetch" href="/assets/js/119.d082b2b6.js"><link rel="prefetch" href="/assets/js/12.02e6e552.js"><link rel="prefetch" href="/assets/js/120.7f91dd90.js"><link rel="prefetch" href="/assets/js/121.6ea6a7a8.js"><link rel="prefetch" href="/assets/js/122.447390a7.js"><link rel="prefetch" href="/assets/js/123.026b5e45.js"><link rel="prefetch" href="/assets/js/124.1540bc47.js"><link rel="prefetch" href="/assets/js/126.d1d79997.js"><link rel="prefetch" href="/assets/js/127.12ed55e3.js"><link rel="prefetch" href="/assets/js/128.1c10f92c.js"><link rel="prefetch" href="/assets/js/129.3fa04f6d.js"><link rel="prefetch" href="/assets/js/13.215ad842.js"><link rel="prefetch" href="/assets/js/130.9ae5e169.js"><link rel="prefetch" href="/assets/js/131.1cc60693.js"><link rel="prefetch" href="/assets/js/132.9938cfd9.js"><link rel="prefetch" href="/assets/js/133.e2eb0fc2.js"><link rel="prefetch" href="/assets/js/134.041a2f39.js"><link rel="prefetch" href="/assets/js/135.d1e73142.js"><link rel="prefetch" href="/assets/js/136.1f20ccec.js"><link rel="prefetch" href="/assets/js/137.4a65f56e.js"><link rel="prefetch" href="/assets/js/138.b4a99d3d.js"><link rel="prefetch" href="/assets/js/139.59fbde60.js"><link rel="prefetch" href="/assets/js/14.1a060010.js"><link rel="prefetch" href="/assets/js/140.0fc474c2.js"><link rel="prefetch" href="/assets/js/141.9c82fe89.js"><link rel="prefetch" href="/assets/js/142.9833a658.js"><link rel="prefetch" href="/assets/js/143.a03dd564.js"><link rel="prefetch" href="/assets/js/144.2d5b3bc6.js"><link rel="prefetch" href="/assets/js/145.a7b1deb5.js"><link rel="prefetch" href="/assets/js/146.bca2e9b9.js"><link rel="prefetch" href="/assets/js/147.c75d1545.js"><link rel="prefetch" href="/assets/js/148.454ab7be.js"><link rel="prefetch" href="/assets/js/149.1ac61fa2.js"><link rel="prefetch" href="/assets/js/15.34674cd6.js"><link rel="prefetch" href="/assets/js/150.3b65ef2d.js"><link rel="prefetch" href="/assets/js/151.2abd57c8.js"><link rel="prefetch" href="/assets/js/152.616f67e5.js"><link rel="prefetch" href="/assets/js/153.368bbf88.js"><link rel="prefetch" href="/assets/js/154.71944687.js"><link rel="prefetch" href="/assets/js/155.7788c140.js"><link rel="prefetch" href="/assets/js/156.94663c3f.js"><link rel="prefetch" href="/assets/js/157.ddfc515b.js"><link rel="prefetch" href="/assets/js/158.42c9ece5.js"><link rel="prefetch" href="/assets/js/159.6a57ee32.js"><link rel="prefetch" href="/assets/js/16.651173ea.js"><link rel="prefetch" href="/assets/js/160.ff2248ac.js"><link rel="prefetch" href="/assets/js/17.780050f1.js"><link rel="prefetch" href="/assets/js/18.e7c67b28.js"><link rel="prefetch" href="/assets/js/19.910fc8d0.js"><link rel="prefetch" href="/assets/js/20.f2e93d17.js"><link rel="prefetch" href="/assets/js/21.8afea724.js"><link rel="prefetch" href="/assets/js/22.6ffcdce5.js"><link rel="prefetch" href="/assets/js/23.fa51555f.js"><link rel="prefetch" href="/assets/js/24.95c29410.js"><link rel="prefetch" href="/assets/js/25.2d1f0877.js"><link rel="prefetch" href="/assets/js/26.8b31cf1a.js"><link rel="prefetch" href="/assets/js/27.2f36650b.js"><link rel="prefetch" href="/assets/js/28.ad131d60.js"><link rel="prefetch" href="/assets/js/29.6a1885cd.js"><link rel="prefetch" href="/assets/js/3.970a66a4.js"><link rel="prefetch" href="/assets/js/30.c5c84c25.js"><link rel="prefetch" href="/assets/js/31.13bd6ce6.js"><link rel="prefetch" href="/assets/js/32.3385e6c7.js"><link rel="prefetch" href="/assets/js/33.f2df8868.js"><link rel="prefetch" href="/assets/js/34.e538e46b.js"><link rel="prefetch" href="/assets/js/35.e0d4eb09.js"><link rel="prefetch" href="/assets/js/36.6af8f25c.js"><link rel="prefetch" href="/assets/js/37.3c72162a.js"><link rel="prefetch" href="/assets/js/38.50de5acb.js"><link rel="prefetch" href="/assets/js/39.0d7d8bb4.js"><link rel="prefetch" href="/assets/js/40.ac0b402d.js"><link rel="prefetch" href="/assets/js/41.1bf4cba8.js"><link rel="prefetch" href="/assets/js/42.0dfc8db2.js"><link rel="prefetch" href="/assets/js/43.6d90bcb2.js"><link rel="prefetch" href="/assets/js/44.cbf7e45f.js"><link rel="prefetch" href="/assets/js/45.168bd8a3.js"><link rel="prefetch" href="/assets/js/46.267b9784.js"><link rel="prefetch" href="/assets/js/47.09433b54.js"><link rel="prefetch" href="/assets/js/48.5fc769af.js"><link rel="prefetch" href="/assets/js/49.698e3da5.js"><link rel="prefetch" href="/assets/js/5.d1da013e.js"><link rel="prefetch" href="/assets/js/50.b050452d.js"><link rel="prefetch" href="/assets/js/51.0c2a7897.js"><link rel="prefetch" href="/assets/js/52.47655db9.js"><link rel="prefetch" href="/assets/js/53.9bcb2247.js"><link rel="prefetch" href="/assets/js/54.ff85b612.js"><link rel="prefetch" href="/assets/js/55.097f7428.js"><link rel="prefetch" href="/assets/js/56.63e79ca9.js"><link rel="prefetch" href="/assets/js/57.1689e3dd.js"><link rel="prefetch" href="/assets/js/58.ccde5fb1.js"><link rel="prefetch" href="/assets/js/59.97ec9015.js"><link rel="prefetch" href="/assets/js/6.9bdf2d86.js"><link rel="prefetch" href="/assets/js/60.38fe8fb4.js"><link rel="prefetch" href="/assets/js/61.b4a85867.js"><link rel="prefetch" href="/assets/js/62.c0d9a7e9.js"><link rel="prefetch" href="/assets/js/63.217bce2a.js"><link rel="prefetch" href="/assets/js/64.0571a2de.js"><link rel="prefetch" href="/assets/js/65.92551134.js"><link rel="prefetch" href="/assets/js/66.35822c0e.js"><link rel="prefetch" href="/assets/js/67.f12819ca.js"><link rel="prefetch" href="/assets/js/68.b329bbb8.js"><link rel="prefetch" href="/assets/js/69.acd17bc5.js"><link rel="prefetch" href="/assets/js/7.8cd56b2f.js"><link rel="prefetch" href="/assets/js/70.f09f7ae0.js"><link rel="prefetch" href="/assets/js/71.1a452b0f.js"><link rel="prefetch" href="/assets/js/72.05fca5e9.js"><link rel="prefetch" href="/assets/js/73.f36add93.js"><link rel="prefetch" href="/assets/js/74.6c27ec85.js"><link rel="prefetch" href="/assets/js/75.a786eaf6.js"><link rel="prefetch" href="/assets/js/76.dca03d61.js"><link rel="prefetch" href="/assets/js/77.af3ce1d2.js"><link rel="prefetch" href="/assets/js/78.0c6f870f.js"><link rel="prefetch" href="/assets/js/79.05962ecd.js"><link rel="prefetch" href="/assets/js/8.6b13a443.js"><link rel="prefetch" href="/assets/js/80.c2c37ed9.js"><link rel="prefetch" href="/assets/js/81.f4b346fe.js"><link rel="prefetch" href="/assets/js/82.e9069ad7.js"><link rel="prefetch" href="/assets/js/83.1c8923e0.js"><link rel="prefetch" href="/assets/js/84.08d63161.js"><link rel="prefetch" href="/assets/js/85.9e65a216.js"><link rel="prefetch" href="/assets/js/86.efc7bce8.js"><link rel="prefetch" href="/assets/js/87.2a4c1c4d.js"><link rel="prefetch" href="/assets/js/88.9b8dd17d.js"><link rel="prefetch" href="/assets/js/89.62bb428a.js"><link rel="prefetch" href="/assets/js/90.486983af.js"><link rel="prefetch" href="/assets/js/91.bbc8b34d.js"><link rel="prefetch" href="/assets/js/92.a2448b1e.js"><link rel="prefetch" href="/assets/js/93.5b30c1f2.js"><link rel="prefetch" href="/assets/js/94.61a41331.js"><link rel="prefetch" href="/assets/js/95.4010f797.js"><link rel="prefetch" href="/assets/js/96.e5129fbb.js"><link rel="prefetch" href="/assets/js/97.4a41079c.js"><link rel="prefetch" href="/assets/js/98.2873b890.js"><link rel="prefetch" href="/assets/js/99.5e275924.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ef15c391.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>How YOU can build a Serverless C# .Net Core API in no time, with bindings and a Database</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/dotnet-serverless-database.html#resources" class="sidebar-link">Resources</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/dotnet-serverless-database.html#serverless" class="sidebar-link">Serverless</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/dotnet-serverless-database.html#core-concepts" class="sidebar-link">Core Concepts</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/dotnet-serverless-database.html#demo" class="sidebar-link">Demo</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/dotnet-serverless-database.html#database" class="sidebar-link">Database</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-serverless-database.html#azure-function-app" class="sidebar-link">Azure Function app</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-serverless-database.html#adding-cosmosdb-input-binding" class="sidebar-link">Adding CosmosDB input binding</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-serverless-database.html#output-bindings" class="sidebar-link">Output bindings</a></li></ul></li><li><a href="/pages/dotnet-serverless-database.html#summary" class="sidebar-link">Summary</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="how-you-can-build-a-serverless-c-net-core-api-in-no-time-with-bindings-and-a-database"><a href="#how-you-can-build-a-serverless-c-net-core-api-in-no-time-with-bindings-and-a-database" aria-hidden="true" class="header-anchor">#</a> How YOU can build a Serverless C# .Net Core API in no time, with bindings and a Database</h1> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/d4si8c2zkxuzp4r3rfhc.jpg" alt=""></p> <p>This article is part of <a href="https://dev.to/azure/serverless-september-content-collection-2fhb" target="_blank" rel="noopener noreferrer">#ServerlessSeptember<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. You'll find other helpful articles, detailed tutorials, and videos in this all-things-Serverless content collection. New articles are published every day â€” that's right, every day â€” from community members and cloud advocates in the month of September.</p> <blockquote><p>Serverless is great in many ways.</p></blockquote> <blockquote><p>Your first impression of Serverless might be that it's saving you money. You've realized that you have some code that can run seldom and you've moved that and made Azure functions out of it. Great, you're already happy at this point, who doesn't like more resources? Then you discover something else that's equally great or even greater. Because it lives in the Cloud it can take to all your services in the Cloud with almost no configuration. How come it's this easy? It's made easy cause we are using something called <em>bindings</em>. So let's talk about Serverless and why and how bindings are part of the success story that is Serverless</p></blockquote> <p>In this article we will cover:</p> <ul><li><strong>Serverless</strong>, what is it, why would we want to use it?</li> <li><strong>Core concepts</strong>, let's cover bindings and trigger</li> <li><strong>Demo</strong>, let's build something using Bindings and Databases and show how easy it is</li></ul> <h2 id="resources"><a href="#resources" aria-hidden="true" class="header-anchor">#</a> Resources</h2> <ul><li><p><a href="https://azure.microsoft.com/en-us/free/?wt.mc_id=servsept_peersonal-blog-chnoring" target="_blank" rel="noopener noreferrer">Sign up for a free Azure account<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
If you want to build Logic Apps and Azure Functions you will need an Azure account, it's free.</p></li> <li><p><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-triggers-bindings?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">Triggers and bindings<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-cosmosdb-v2#input---c-examples?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">Great example page for using Triggers and bindings in different languages<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="http://dontcodetired.com/blog/post/Reading-Azure-Cosmos-DB-Data-In-Azure-Functions" target="_blank" rel="noopener noreferrer">Great article on CosmosDB and Azure Functions<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
Great article, great blog in general</p></li> <li><p><a href="https://docs.microsoft.com/en-us/learn/modules/chain-azure-functions-data-using-bindings/?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">LEARN module for working with bindings and Triggers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <h2 id="serverless"><a href="#serverless" aria-hidden="true" class="header-anchor">#</a> Serverless</h2> <blockquote><p>Serverless is on everyone's lips right now. Serverless this Serverless that. Why is that?</p></blockquote> <p>Part of the reason is that Cloud nowadays has become the default hosting platform, no more server rooms <em>almost</em>. The Cloud is really someone else server room but the bottom line is that you don't have to care. There are so many things the Cloud helps with, security, reliability, backup, scalability and most of all the ability for other things that live in the Cloud to talk to each other.</p> <blockquote><p>So why is that great?</p></blockquote> <p>Most companies have a ton of services that together makes out the IT landscape they call a business. Getting all or most of these services to talk to each other is an all-consuming task or at least it requires a lot of resources. Most Clouds today are really good at connecting these services within the Cloud and even cross Cloud.</p> <blockquote><p>So where does Serverless fit in?</p></blockquote> <p>Serverless has arrived after many steps of cloud evolution in which we first decided to NOT manage the hardware anymore. Then we decided that we didn't want to deal with app servers. So we arrived at the point where we just wanted to focus on code, code, and nothing but the code. That meant a whole new platform was born or FaaS, function as a service. With the arrival of Serverless, we realized something else. We started to realize more and more we only wanted to pay for actual code execution and that's just what Serverless offers - fully managed and pay for what you use.</p> <blockquote><p>That's not why we read this article though?</p></blockquote> <p>Correct, we are here to learn about how to integrate Serverless functions with other things using something called <em>bindings</em>.</p> <h2 id="core-concepts"><a href="#core-concepts" aria-hidden="true" class="header-anchor">#</a> Core Concepts</h2> <p>There are three major concepts we need to understand when it comes to integration and Serverless, those are</p> <ul><li><strong>Triggers</strong>, this is how our function can be invoked. What causes an invocation could be everything from an HTTP call, new database entry to a new message on a queue and even more other things. The Point is, triggers are what <em>starts</em> our function.</li> <li><strong>Input binding</strong>, this a connection to some kind of data source. The point is to read data from this data source. This could be everything from an Excel document, Database or a Queue</li> <li><strong>Output binding</strong>, this is us creating a connection to a database with the explicit intent of wanting to change data. Typically we get access to a record that we can populate and this record goes into the data source to typically update or create new data</li></ul> <p>There, now we know the most important concepts that we need to know to get started.</p> <h2 id="demo"><a href="#demo" aria-hidden="true" class="header-anchor">#</a> Demo</h2> <p>Ok so what are we building? Well, to showcase how great Serverless let's try to connect with at least two things. That means we will need to build/provision:</p> <ul><li><strong>Database</strong>, we will provision a CosmosDB Database</li> <li><strong>Azure Function App</strong>, of course, we will need to build an Azure Function App that connects with our database</li></ul> <h3 id="database"><a href="#database" aria-hidden="true" class="header-anchor">#</a> Database</h3> <p>This step is pretty straight forward. What we need to do is log in to the Azure Portal. You do have an account right? If not, create a free one here <a href="https://azure.microsoft.com/en-gb/free/?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">Free Azure account<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Here are all the steps we need to take:</p> <ol><li><strong>Provision</strong> our Database</li> <li><strong>Set up</strong> the database and add sample data</li></ol> <p><strong>Provision our Database</strong></p> <p>Ok, so we have logged in to the portal. Now let's provision a database like so:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/xigs7t567fu6c68381ui.png" alt=""></p> <p>Thereafter we need to enter some information about our database. Below we have indicated all the mandatory fields we need to fill in. Ensure you select <code>API</code> as <code>Core(SQL)</code> and also ensures you have picked a <code>Location</code> that's close to you for best response times.</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/uzw4wwwxp8cdho5fn7rm.png" alt=""></p> <p>Lastly, hit <code>Review + Create</code> at the bottom. This should trigger provisioning. A few minutes later your resource/database should be ready for use.</p> <p><strong>Set up the database</strong></p> <p>Now our resource has been provisioned and it's ready for use to configure it. The first thing we are going to do is to add a Container.</p> <blockquote><p>What is a container?</p></blockquote> <p>Glad you asked ðŸ˜ƒ A container is what actually will hold our data or entities. The container itself contains something called <em>documents</em>.</p> <p>To create the container we select <code>Data explorer</code> from the left menu and then click <code>New Container</code>, like so:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/8sjzdb4xcue9cs8rar9n.png" alt=""></p> <p>Next step is to fill in all the details needed to create a container.</p> <p>It will ask you to fill in the following fields:</p> <ul><li><strong>Database id</strong>, you can give it whatever name you want, I choose to name it <strong>database-chris</strong></li> <li><strong>Throughput</strong>, give it the value <strong>1000</strong></li> <li><strong>Container id</strong>, this is the name of the collection. A collection holds a list of documents. Every document is like a row in a table, with table and collection being roughly the same thing. Give it the name <strong>Bookmarks</strong></li> <li><strong>Partition key</strong>, The partition key specifies how the documents in Azure Cosmos DB collections are distributed across logical data partitions. What does that even mean? It means this database scales in the Cloud. We tell it how to scale and how to use a technique used <em>sharding</em> to do so. Give the value <strong>/id</strong></li></ul> <p>The form will look like this:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/hrcdcez6fm9h5qyecovv.png" alt=""></p> <p><strong>Add sample data</strong></p> <p>Ok now the database is set up and we can start filling it with some data. So the next step is to click our <code>Collection</code> bookmarks and then <code>Items</code>. Thereafter click <code>Net Item</code> to insert a record in our collection, like so:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/ukbh9x0rq8015gztwtap.png" alt=""></p> <p>As you can see to the right it has opened up a textarea that we can use to insert data. Let's change that to the following:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
    &quot;id&quot;: &quot;docs&quot;,
    &quot;url&quot;: &quot;https://docs.microsoft.com/azure&quot;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>and click <code>Save</code>. Add a few more records like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
    &quot;id&quot;: &quot;portal&quot;,
    &quot;url&quot;: &quot;https://portal.azure.com&quot;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>and a last one:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
    &quot;id&quot;: &quot;learn&quot;,
    &quot;url&quot;: &quot;https://docs.microsoft.com/learn&quot;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="azure-function-app"><a href="#azure-function-app" aria-hidden="true" class="header-anchor">#</a> Azure Function app</h3> <p>Ok, then we have a database, a data source. Now it's time for us to build an Azure Function app and an Azure Function and really demonstrate how easy it is to connect our data source. We will do the following:</p> <ol><li><strong>Scaffold</strong> an Azure Function app and an Azure Function</li> <li><strong>Set up</strong> a connection to the database</li> <li><strong>Read</strong> from our database and thereby learn about input bindings</li> <li><strong>Write</strong> to our database and thereby learn output bindings</li></ol> <p><strong>Prerequisites</strong></p> <p>To be able to scaffold our Azure Function app we need a few things installed namely</p> <ul><li><a href="https://github.com/Azure/azure-functions-core-tools#installing" target="_blank" rel="noopener noreferrer">Azure Core Tools<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Azure Functions extension for VS Code, <a href="vscode:extension/ms-azuretools.vscode-azurefunctions">Extension</a></li> <li>A free Azure Account or an existing one if you have that,  <a href="https://azure.microsoft.com/free/?wt.mc_id=twitter-social-chnoring" target="_blank" rel="noopener noreferrer">Free account<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <blockquote><p>Ok, all setup?</p></blockquote> <p>Good, let's continue! ðŸ˜ƒ</p> <p><strong>Scaffold an Azure Function App</strong></p> <p>Open up VS Code. Select <code>View/Command Palette</code> (Ctrl + Shift + P on Windows, CMD + Shift + P on Mac).</p> <p>Start typing for <code>Azure Function: Create new Project</code> and select it.</p> <ul><li>Select the current folder</li> <li>Select C# as language</li> <li>Select HttpTrigger for our first function</li> <li>Give it the name <code>Bookmarks</code></li> <li>You name the namespace anything you want but let's go with <code>Company</code>.</li> <li>Choose the authorization type <code>Function</code></li></ul> <p>A window will popup to <code>restore dependencies</code>. Click that or if you miss it head to the terminal and type <code>dotnet restore</code>. This is so it downloads all the dependent library that it has specified.</p> <p>Ok then. We have gotten ourselves a function called <code>Bookmarks</code>, it resides in the <code>Bookmarks.cs</code>, like so:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/9elzk1f0kjmrn7dm4vqs.png" alt=""></p> <p>Let's open up <code>Bookmarks.cs</code> shall we?</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// Bookmarks.cs</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Mvc<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>Azure<span class="token punctuation">.</span>WebJobs<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>Azure<span class="token punctuation">.</span>WebJobs<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Http<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Http<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Logging<span class="token punctuation">;</span>
<span class="token keyword">using</span> Newtonsoft<span class="token punctuation">.</span>Json<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic<span class="token punctuation">;</span>

<span class="token keyword">namespace</span> Company
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Bookmark</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">string</span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">string</span> Url <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Bookmarks</span>
    <span class="token punctuation">{</span>
        <span class="token punctuation">[</span><span class="token class-name">FunctionName</span><span class="token punctuation">(</span><span class="token string">&quot;Bookmarks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span>IActionResult<span class="token operator">&gt;</span> <span class="token function">Run</span><span class="token punctuation">(</span>
          <span class="token punctuation">[</span><span class="token class-name">HttpTrigger</span><span class="token punctuation">(</span>
            AuthorizationLevel<span class="token punctuation">.</span>Function<span class="token punctuation">,</span> 
            <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> 
            <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span> 
            Route <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
          <span class="token punctuation">]</span> <span class="token class-name">HttpRequest</span> req<span class="token punctuation">,</span>
            <span class="token class-name">ILogger</span> log
            <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">LogInformation</span><span class="token punctuation">(</span><span class="token string">&quot;C# HTTP trigger function processed a request.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">string</span> name <span class="token operator">=</span> req<span class="token punctuation">.</span>Query<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token keyword">string</span> requestBody <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">StreamReader</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>Body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ReadToEndAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">dynamic</span> data <span class="token operator">=</span> JsonConvert<span class="token punctuation">.</span><span class="token function">DeserializeObject</span><span class="token punctuation">(</span>requestBody<span class="token punctuation">)</span><span class="token punctuation">;</span>
            name <span class="token operator">=</span> name <span class="token operator">??</span> data<span class="token punctuation">?.</span>name<span class="token punctuation">;</span>

            <span class="token keyword">return</span> name <span class="token operator">!=</span> <span class="token keyword">null</span>
                <span class="token punctuation">?</span> <span class="token punctuation">(</span>ActionResult<span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token class-name">OkObjectResult</span><span class="token punctuation">(</span>$<span class="token string">&quot;Hello, {name}&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">BadRequestObjectResult</span><span class="token punctuation">(</span><span class="token string">&quot;Please pass a name on the query string or in the request body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p>What we are most interested in is the top of our function, let's zoom in on that:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">FunctionName</span><span class="token punctuation">(</span><span class="token string">&quot;Bookmarks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span>IActionResult<span class="token operator">&gt;</span> <span class="token function">Run</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span><span class="token class-name">HttpTrigger</span><span class="token punctuation">(</span>AuthorizationLevel<span class="token punctuation">.</span>Function<span class="token punctuation">,</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span> Route <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token class-name">HttpRequest</span> req<span class="token punctuation">,</span>
  <span class="token class-name">ILogger</span> log
<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* function body */</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>We can see that the attribute <code>FunctionName</code> is used to determine that we are dealing with a function and that it's called <code>Bookmarks</code>. Then we can see that we have an attribute <code>HttpTrigger</code> that says it can be triggered by an HTTP call.</p> <h3 id="adding-cosmosdb-input-binding"><a href="#adding-cosmosdb-input-binding" aria-hidden="true" class="header-anchor">#</a> Adding CosmosDB input binding</h3> <p>Ok, so how do we add CosmosDB to this? Well, there are two ways:</p> <ol><li><p><strong>Add the CosmosDB attribute</strong> to our <code>Bookmarks.cs</code> file and then install the correct NuGet package from the terminal to ensure everything compiles</p></li> <li><p><strong>Add a function with a CosmosDB trigger</strong>, this will install the needed dependencies and will also trigger a storage dialog that makes you choose a storage account, the name of your database and your collection</p></li></ol> <p>Let's try out the first option. First, let's open up a terminal and type:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>dotnet add package Microsoft.Azure.WebJobs.Extensions.CosmosDB
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Now we are ready for the next step which is to add an input binding to our <code>Bookmarks.cs</code> file.</p> <p>To do that we will use an attribute class called <code>CosmosDB</code>. We need to give it some values namely</p> <ul><li><strong>database name</strong>,  this is what we named our database so that's <strong>database-chris</strong></li> <li><strong>collection name</strong>, we named our collection <strong>Bookmarks</strong></li> <li><strong>connection string</strong>, as for connection string, this is something we can find in our Azure Portal. Go to your resource click <strong>Keys</strong> in the menu and then copy the value displayed in <strong>PRIMARY CONNECTION STRING</strong></li></ul> <p>Now, database name and collection name are things we can add in the code, like so:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// excerpt from Bookmarks.cs</span>

<span class="token punctuation">[</span><span class="token class-name">FunctionName</span><span class="token punctuation">(</span><span class="token string">&quot;Bookmarks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span>IActionResult<span class="token operator">&gt;</span> <span class="token function">Run</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span><span class="token class-name">HttpTrigger</span><span class="token punctuation">(</span>AuthorizationLevel<span class="token punctuation">.</span>Function<span class="token punctuation">,</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span> Route <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token class-name">HttpRequest</span> req<span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token class-name">CosmosDB</span><span class="token punctuation">(</span><span class="token string">&quot;database-chris&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Bookmarks&quot;</span><span class="token punctuation">,</span> ConnectionStringSetting <span class="token operator">=</span><span class="token string">&quot;CosmosDB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>IEnumerable<span class="token operator">&lt;</span>Bookmark<span class="token operator">&gt;</span> bookmarks
  <span class="token class-name">ILogger</span> log
<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* function body */</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>So above we have added the attribute class <code>CosmosDB</code> and <em>decorated</em> the parameter <code>bookmarks</code>. We can see that <code>bookmarks</code> is of type <code>IEnumerable&lt;Bookmarks&gt;</code></p> <blockquote><p>where does the type <code>Bookmark</code> come from?</p></blockquote> <p>That's a type we need to create, either in <code>Bookmarks.cs</code> or it's own file, but it needs to have the following shape:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Bookmark</span> 
<span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">string</span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token keyword">string</span> Url <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>It has the properties <code>Id</code> and <code>Url</code> to match the shape it has in the database.</p> <p>Looking further at the code, we give <code>ConnectionStringSetting</code> the value <code>CosmosDB</code></p> <blockquote><p>where does it come from?</p></blockquote> <p>It comes from a file <code>local.settings.json</code> and its <code>Values</code> property, like so:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;IsEncrypted&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;Values&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;FUNCTIONS_WORKER_RUNTIME&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dotnet&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;CosmosDB&quot;</span><span class="token operator">:</span> <span class="token string">&quot;value of primary connection string&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>Trying it out</strong></p> <p>Let's first set a debugger  on the first row of our function in <code>Bookmarks.cs</code>.</p> <p>In the menu of VS Code select <code>Debug/ Start Debugging</code>.</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/yamon2cfp0gzfzjxuios.png" alt=""></p> <p>Go to the browser and input <code>http://localhost:7071/Bookmarks</code> and your breakpoint should be hit, like so:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/qigybiof4aegyrkxiwcv.png" alt=""></p> <p>As you can see our <code>bookmarks</code> variable is populated with data, we are talking to the database and it is giving us data, success ðŸ˜ƒ</p> <p><strong>Limiting our response</strong></p> <p>Now the above is great, we get data back from the Database. However, we might have millions of records in there, how do we limit our response?</p> <p>That's easy to do, we need to add two parameters to our <code>CosmosDB</code> attribute, namely:</p> <ul><li>Id</li> <li>PartitionKey</li></ul> <p>It's worth learning about partition keys. So have a read here <a href="http://www.anderbakk.com/designing-a-partition-key-for-cosmos-db/" target="_blank" rel="noopener noreferrer">Partition keys for CosmosDB<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Ok, so what we will do is to add a new function that will be able to take a <code>query</code> parameter from our trigger and use that to query CosmosDB. So add the following function:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">FunctionName</span><span class="token punctuation">(</span><span class="token string">&quot;GetBookmark&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">IActionResult</span> <span class="token function">GetBookmark</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span><span class="token class-name">HttpTrigger</span><span class="token punctuation">(</span>AuthorizationLevel<span class="token punctuation">.</span>Function<span class="token punctuation">,</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> Route<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token class-name">HttpRequest</span> req<span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token class-name">CosmosDB</span><span class="token punctuation">(</span>
  <span class="token string">&quot;database-chris&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;Bookmarks&quot;</span><span class="token punctuation">,</span>
  ConnectionStringSetting <span class="token operator">=</span> <span class="token string">&quot;CosmosDB&quot;</span><span class="token punctuation">,</span> 
  Id <span class="token operator">=</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>
  PartitionKey <span class="token operator">=</span> <span class="token string">&quot;{Query.id}&quot;</span>
<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token class-name">Bookmark</span> bookmark<span class="token punctuation">,</span> 
  <span class="token class-name">ILogger</span> log
<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>ActionResult<span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token class-name">OkObjectResult</span><span class="token punctuation">(</span>bookmark<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>Now start up our application and run the following URL in the browser <code>http://localhost:7071/api/GetBookmark?id=portal</code>. This will ensure that our CosmosDB is queried for <code>id</code> with the value <code>portal</code>. The result should be this:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/mbm0y7r21vq0d8kv17i0.png" alt=""></p> <h3 id="output-bindings"><a href="#output-bindings" aria-hidden="true" class="header-anchor">#</a> Output bindings</h3> <p>We used input bindings to read from a database. Output bindings are used to write to a database. Let's look at two different scenarios.</p> <ul><li><strong>Create</strong>, we will take query parameters from our trigger and use those to create an entry in our database</li> <li><strong>Update</strong>, We will take an existing entry and update that</li></ul> <p><strong>Create</strong></p> <p>Ok then, what's needed to create an output binding? Well, it's almost nothing. The only thing we need is a new parameter in a function of type <code>out</code>, like so:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">out</span> <span class="token keyword">dynamic</span> bookmark
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Let's create a new dedicated function though and call it <code>CreateBookmark</code> and define it like so:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">FunctionName</span><span class="token punctuation">(</span><span class="token string">&quot;CreateBookmark&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">IActionResult</span> <span class="token function">CreateBookmark</span><span class="token punctuation">(</span>
        <span class="token punctuation">[</span><span class="token class-name">HttpTrigger</span><span class="token punctuation">(</span>AuthorizationLevel<span class="token punctuation">.</span>Function<span class="token punctuation">,</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span> Route<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token class-name">HttpRequest</span> req<span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token class-name">CosmosDB</span><span class="token punctuation">(</span><span class="token string">&quot;database-chris&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Bookmarks&quot;</span><span class="token punctuation">,</span>
            ConnectionStringSetting <span class="token operator">=</span> <span class="token string">&quot;CosmosDB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">out</span> <span class="token keyword">dynamic</span> bookmark<span class="token punctuation">,</span>
            <span class="token class-name">ILogger</span> log
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">string</span> id <span class="token operator">=</span> req<span class="token punctuation">.</span>Query<span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">string</span> url <span class="token operator">=</span> req<span class="token punctuation">.</span>Query<span class="token punctuation">[</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        bookmark <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> id <span class="token operator">=</span> id<span class="token punctuation">,</span> url <span class="token operator">=</span> url <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token punctuation">(</span>ActionResult<span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token class-name">OkObjectResult</span><span class="token punctuation">(</span><span class="token string">&quot;created&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Now fire up the program and enter a URL like so <code>http://localhost:7071/api/CreateBookmark?id=devto&amp;url=dev.to%2Fsoftchris</code>  in the browser. That's it, this should create new entry. Don't believe me? Have a look at your database in the portal:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/zlmv0pmxq6axcqdfhsw8.png" alt=""></p> <p><strong>Update</strong></p> <p>Well, because this is CosmosDB. This means that if there is a pre-existing record with that id value if will simply be replaced. However, that might not be what you had in mind. If you only wanted to update certain properties I recommend the following approach:</p> <ol><li><strong>Use</strong> an input binding to retrieve an existing record</li> <li><strong>Copy</strong> the values from that input record to the output binding</li> <li><strong>Copy</strong> whatever values you get from a trigger to the output binding</li></ol> <p>That's it, that's the two update scenarios we have.</p> <h2 id="summary"><a href="#summary" aria-hidden="true" class="header-anchor">#</a> Summary</h2> <p>We've learned about input bindings as well as output bindings. We learned that input bindings allowed us to read from the database and output bindings allowed us to create or update data. Additionally, we've learned how to provision a CosmosDB database and connect to it using an attribute class called CosmosDB. It's definitely possible to have CosmosDB as a trigger as well but that will be another article ðŸ˜ƒ</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4ba00308.js" defer></script><script src="/assets/js/9.454b5262.js" defer></script><script src="/assets/js/4.eac68367.js" defer></script><script src="/assets/js/125.76dfd28a.js" defer></script>
  </body>
</html>
