<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>No more tears, handling Forms in React using Formik, part II</title>
    <meta name="description" content="[object Object]">
    
    
    <link rel="preload" href="/assets/css/0.styles.b244743b.css" as="style"><link rel="preload" href="/assets/js/app.1e960872.js" as="script"><link rel="preload" href="/assets/js/7.1b275639.js" as="script"><link rel="preload" href="/assets/js/6.6ae5d1ce.js" as="script"><link rel="preload" href="/assets/js/40.c814f3ec.js" as="script"><link rel="prefetch" href="/assets/js/1.1b576644.js"><link rel="prefetch" href="/assets/js/10.7bac90a4.js"><link rel="prefetch" href="/assets/js/11.01a6b72e.js"><link rel="prefetch" href="/assets/js/12.8977a44a.js"><link rel="prefetch" href="/assets/js/13.ce52cddb.js"><link rel="prefetch" href="/assets/js/14.db698ecd.js"><link rel="prefetch" href="/assets/js/15.b0f1e8e5.js"><link rel="prefetch" href="/assets/js/16.0538f0f9.js"><link rel="prefetch" href="/assets/js/17.7ce6a9cd.js"><link rel="prefetch" href="/assets/js/18.ac4238a8.js"><link rel="prefetch" href="/assets/js/19.0a6d2469.js"><link rel="prefetch" href="/assets/js/20.20c70880.js"><link rel="prefetch" href="/assets/js/21.e0b2aeea.js"><link rel="prefetch" href="/assets/js/22.fc2df48a.js"><link rel="prefetch" href="/assets/js/23.6725fd4b.js"><link rel="prefetch" href="/assets/js/24.41601cd0.js"><link rel="prefetch" href="/assets/js/25.7fec6931.js"><link rel="prefetch" href="/assets/js/26.5a5311b6.js"><link rel="prefetch" href="/assets/js/27.b5bb63d4.js"><link rel="prefetch" href="/assets/js/28.4ea40dfe.js"><link rel="prefetch" href="/assets/js/29.b89918fd.js"><link rel="prefetch" href="/assets/js/3.262e56e6.js"><link rel="prefetch" href="/assets/js/30.52a1a7ce.js"><link rel="prefetch" href="/assets/js/31.51bb42b6.js"><link rel="prefetch" href="/assets/js/32.168ae141.js"><link rel="prefetch" href="/assets/js/33.e8de89e0.js"><link rel="prefetch" href="/assets/js/34.2b551cd3.js"><link rel="prefetch" href="/assets/js/35.af4bd5a4.js"><link rel="prefetch" href="/assets/js/36.589ace7f.js"><link rel="prefetch" href="/assets/js/37.47df7bf2.js"><link rel="prefetch" href="/assets/js/38.c853eb6a.js"><link rel="prefetch" href="/assets/js/39.a85380b9.js"><link rel="prefetch" href="/assets/js/4.56ae630c.js"><link rel="prefetch" href="/assets/js/41.3c0de036.js"><link rel="prefetch" href="/assets/js/42.556fa283.js"><link rel="prefetch" href="/assets/js/43.341766c6.js"><link rel="prefetch" href="/assets/js/44.59b89af6.js"><link rel="prefetch" href="/assets/js/45.3f79dff7.js"><link rel="prefetch" href="/assets/js/46.85d5af36.js"><link rel="prefetch" href="/assets/js/47.b7a4be5e.js"><link rel="prefetch" href="/assets/js/48.91c06bb6.js"><link rel="prefetch" href="/assets/js/49.8b1b0d47.js"><link rel="prefetch" href="/assets/js/5.373600b1.js"><link rel="prefetch" href="/assets/js/50.19977a11.js"><link rel="prefetch" href="/assets/js/51.7d9f282a.js"><link rel="prefetch" href="/assets/js/52.97ef961e.js"><link rel="prefetch" href="/assets/js/53.079f7b19.js"><link rel="prefetch" href="/assets/js/54.d24a1bb1.js"><link rel="prefetch" href="/assets/js/55.37fb4d6e.js"><link rel="prefetch" href="/assets/js/56.01b047b4.js"><link rel="prefetch" href="/assets/js/57.b7309198.js"><link rel="prefetch" href="/assets/js/58.8d508f80.js"><link rel="prefetch" href="/assets/js/59.c6f420e6.js"><link rel="prefetch" href="/assets/js/60.0d0d60b5.js"><link rel="prefetch" href="/assets/js/61.6e98b987.js"><link rel="prefetch" href="/assets/js/62.f471b55a.js"><link rel="prefetch" href="/assets/js/63.8962551b.js"><link rel="prefetch" href="/assets/js/64.65da64a1.js"><link rel="prefetch" href="/assets/js/65.830799e0.js"><link rel="prefetch" href="/assets/js/66.2f98a845.js"><link rel="prefetch" href="/assets/js/67.8cf8cba3.js"><link rel="prefetch" href="/assets/js/68.75af31a4.js"><link rel="prefetch" href="/assets/js/69.8f6a0c8b.js"><link rel="prefetch" href="/assets/js/8.a354cea0.js"><link rel="prefetch" href="/assets/js/9.be23d1a2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b244743b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>No more tears, handling Forms in React using Formik, part II</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/formik-partII.html#built-in-components" class="sidebar-link">Built-in components</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/formik-partII.html#schema-validation-with-yup" class="sidebar-link">Schema validation with Yup</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/formik-partII.html#async-validation" class="sidebar-link">Async validation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/formik-partII.html#async-on-field-level" class="sidebar-link">Async on field level</a></li><li class="sidebar-sub-header"><a href="/pages/formik-partII.html#words-of-caution" class="sidebar-link">Words of caution</a></li></ul></li><li><a href="/pages/formik-partII.html#summary" class="sidebar-link">Summary</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="no-more-tears-handling-forms-in-react-using-formik-part-ii"><a href="#no-more-tears-handling-forms-in-react-using-formik-part-ii" aria-hidden="true" class="header-anchor">#</a> No more tears, handling Forms in React using Formik, part II</h1> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/8e17rqk4bamdm1spw90m.jpg" alt=""></p> <blockquote><p>This is the continuation of our first part on Formik, the amazing Forms library for React</p></blockquote> <p>This article is part of a series:</p> <ul><li><a href="https://dev.to/azure/no-more-tears-handling-forms-in-react-using-formik-part-i-20kp" target="_blank" rel="noopener noreferrer">No more tears, handling Forms in React using Formik, part I<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>No more tears, handling Forms in React using Formik, part II, we are here</li></ul> <p>In this article we will cover:</p> <ul><li><strong>Schema Validation</strong> with Yup, there is an alternate way to validate your input elements and that is by declaring a schema in Yup and simply assign that to an attribute on the Formik component</li> <li><strong>Async</strong> validation</li> <li><strong>Built-in components</strong>, make everything less verbose using some of Formiks built-in components</li></ul> <p>##Â Resources
I have made a repo for both these articles, so if you get stuck have a look here <a href="https://github.com/softchris/formik-example/" target="_blank" rel="noopener noreferrer">Form demo repo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="built-in-components"><a href="#built-in-components" aria-hidden="true" class="header-anchor">#</a> Built-in components</h2> <p>So far we have been using regular HTML elements like <code>form</code> and <code>input</code> to build our <code>form</code> and we have connected to events like <code>onSubmit</code>, <code>onChange</code> and <code>onBlur</code>. But we can actually be typing a lot less. Say hello to the following components:</p> <ul><li><strong>Form</strong>, this replaces a normal <code>form</code> element</li> <li><strong>Field</strong>, this replaces any type of <code>input</code> element</li> <li><strong>ErrorMessage</strong>, this doesn't really replace any controls that you have but is a great component that given the attribute <code>name</code> is able to show your error message</li></ul> <p>Let's first look at a simple form and then rewrite it using the above-mentioned components:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Formik <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'formik'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">FormikExample</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Formik</span></span>
    <span class="token attr-name">initialValues</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token attr-name">validation</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">values</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> errors <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>values<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        errors<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Name is required'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> errors<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>values <span class="token operator">=</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'submitted'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
  <span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> handleSubmit<span class="token punctuation">,</span> handleChange<span class="token punctuation">,</span> values<span class="token punctuation">,</span> errors <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>values<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token punctuation">{</span>errors<span class="token punctuation">.</span>name <span class="token operator">&amp;&amp;</span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>errors<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">}</span><span class="token plain-text">
   </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Formik</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>Ok, above we see what a minimal implementation looks like the classical way of doing it, that is using HTML elements like <code>form</code> and <code>input</code>.</p> <p>Now lets clean this up using Formiks built-in controls:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Formik<span class="token punctuation">,</span> Form<span class="token punctuation">,</span> Field<span class="token punctuation">,</span> ErrorMessage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'formik'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>


<span class="token keyword">const</span> <span class="token function-variable function">FormikExample</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Formik</span></span>
    <span class="token attr-name">initialValues</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token attr-name">validation</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">values</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> errors <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>values<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        errors<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Name is required'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> errors<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>values <span class="token operator">=</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'submitted'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
  <span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> handleSubmit<span class="token punctuation">,</span> errors <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Form</span></span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Field</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ErrorMessage</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    }
   </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Form</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Formik</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>Not super impressed? Let's list what we don't need to type anymore:</p> <ul><li>the <code>onChange</code> disappears from each <code>input</code> element</li> <li>the <code>input</code> element is replaced by <code>Field</code> component</li> <li>the <code>form</code> element is replaced by <code>Form</code> component</li> <li>the conditional <code>{errors.name &amp;&amp;</code> disappears as well as <code>ErrorMessage</code> component takes care of that bit</li></ul> <p>Not enough? Well imagine you have 10 fields, that is at least 10 lines of code that disappears and it generally it just looks cleaner. Now to our next improvement, we can replace our <code>validation()</code> function with a <code>schema</code>, up next.</p> <h2 id="schema-validation-with-yup"><a href="#schema-validation-with-yup" aria-hidden="true" class="header-anchor">#</a> Schema validation with Yup</h2> <p>Ok, we've covered how we can really clean up our markup by using the builtin controls <code>Form</code>, <code>Field</code> and <code>ErrorMessage</code>. Next step is improving even more by replacing our <code>validation</code> property with a <code>validationSchema</code> property. For that to be possible we need to define a schema using the library Yup. So what does a schema look like :</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Yup <span class="token keyword">from</span> <span class="token string">'yup'</span>

<span class="token keyword">const</span> schema <span class="token operator">=</span> Yup<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">shape</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    firstName<span class="token punctuation">:</span> Yup<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Too Short!'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'Too Long!'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token string">'Required'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    lastName<span class="token punctuation">:</span> Yup<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Too Short!'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'Too Long!'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token string">'Required'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    email<span class="token punctuation">:</span> Yup<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">email</span><span class="token punctuation">(</span><span class="token string">'Invalid email'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token string">'Required'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>The above schema defines three different fields <code>firstName</code>, <code>lastName</code> and <code>email</code> and gives them each attributes that they should adhere to:</p> <ul><li><strong>firstName</strong>, this should be a string consisting of min 2 characters and maximum 50 characters and its also required</li> <li><strong>lastName</strong>, this is also a string with the same min/max requirements and it's also required</li> <li><strong>email</strong>, this is just a string that is required</li></ul> <p>As you can see the above is quite readable and by defining your data like this you save yourself from having to type a lot of <code>if</code> constructs checking if all attributes are fulfilled.</p> <p>Let's now put it to use in our <code>Formik</code> element, like so:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Formik</span></span> <span class="token attr-name">validationSchema</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>schema<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>That's it, that is all you need to define your form data in a really expressive way, doesn't that give you a warm and fuzzy feeling? ðŸ˜ƒ</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/inn336qns6kslgfg1nun.gif" alt=""></p> <h2 id="async-validation"><a href="#async-validation" aria-hidden="true" class="header-anchor">#</a> Async validation</h2> <p>Ok, now to our last topic, asynchronous validation. So what's the scenario? Well, sometimes you have data that you can't really tell on client side only whether the entered value is correct or not. Imagine you have a form where you want to find out whether a company or certain web page domain is already taken? At that point, you most likely will need to make a call to an endpoint and the endpoint will not be coming back with the answer instantly.</p> <p>Ok, we've set the scene, how do we solve this in Formik? Well, the <code>validation</code> property is able to accept a Promise as well. Really, you think? That easy? Well, the solution is in my mind a bit unorthodox, let me show you what I mean:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token operator">&lt;</span>Formik
  validate<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">values</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'validating async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> errors <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        errors<span class="token punctuation">.</span>companyName <span class="token operator">=</span> <span class="token string">'not cool'</span><span class="token punctuation">;</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>errors<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">throw</span> errors<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">&gt;</span>
<span class="token comment">// define the rest here</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Formik</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>Looking at our <code>validate</code> implementation we see that we create a Promise that internally runs a <code>setTimout</code> to simulate it going to an endpoint that it takes time to get an answer from. At this point we set a <code>errors.companyName</code> to an error text:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  errors<span class="token punctuation">.</span>companyName <span class="token operator">=</span> <span class="token string">'not cool'</span><span class="token punctuation">;</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>In more real scenario we would probably call a function and depending on the functions answer we would possibly assign <code>errors.companyName</code>. I'll show you below what I mean:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">isCompanyNameUnique</span><span class="token punctuation">(</span>values<span class="token punctuation">.</span>companyName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">isUnique</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isUnique<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    errors<span class="token punctuation">.</span>companyName <span class="token operator">=</span> <span class="token template-string"><span class="token string">`companyName is not unique, please select another one`</span></span>
  <span class="token punctuation">}</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Next thing that happens in our code is that we invoke <code>then()</code>, that happens when we call <code>resolve()</code>. Something really interesting happens in there, we check the <code>errors</code> for any properties that might have been set and if so we throw an error with our <code>errors</code> object as an argument, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>errors<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> errors<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>I don't know about you, but to me, this looks a bit weird. I would have thought providing <code>validation</code> with a Promise would have meant that a <code>reject()</code> of the Promise would have been a more intuitive way of doing it, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// this to me would have been more intuitive, but observe, this is NOT how it works, so DONT copy this text but refer to the above code instead</span>

validation<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token parameter">values</span> <span class="token operator">=&gt;</span> 
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'validating async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> errors <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      errors<span class="token punctuation">.</span>companyName <span class="token operator">=</span> <span class="token string">'not cool'</span><span class="token punctuation">;</span>
      <span class="token function">reject</span><span class="token punctuation">(</span>errors<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="async-on-field-level"><a href="#async-on-field-level" aria-hidden="true" class="header-anchor">#</a> Async on field level</h3> <p>So far we have shown how to do async validation on Forms level but if you think about would you really want that? Most likely you have a mix of fields where it's enough to validate some of them client side while only a minority if fields need async validation. In such a case it makes sense to apply validation per field. That is quite easy to achieve by typing like this:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Field name=&quot;username&quot; validate={this.validate} &gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This is probably preferred if you got async validation on a field. As for the other fields, you can validate client side it's probably a good idea to define those in on the <code>Formik</code> components <code>validationSchema</code> and use <code>Yup</code> schemas for that as we've described above.</p> <h3 id="words-of-caution"><a href="#words-of-caution" aria-hidden="true" class="header-anchor">#</a> Words of caution</h3> <p>If we do have async validation in there make sure your validations don't run too often especially if the validation takes time. You don't want a 3-sec validation to trigger every time a key is typed, at most you want it when the user leaves the field to start typing in another field, we refer to this as the <code>blur</code> event. So make sure you set up your <code>Formik</code> component like this:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Formik</span></span>
  <span class="token attr-name">validateOnBlur</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span></span> 
  <span class="token attr-name">validateOnChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span></span> <span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>This does what you want, setting <code>validateOnBlur</code> to <code>true</code> is what you want, even though technically this is <code>true</code> by default. You want to be explicit with the next one though <code>validateOnChange</code>. You want this to be off, or set to <code>false</code>.</p> <h2 id="summary"><a href="#summary" aria-hidden="true" class="header-anchor">#</a> Summary</h2> <p>We've set out to cover built-in components like <code>Form</code>, <code>Field</code> and <code>ErrorMessage</code>, the end result was us cleaning up a lot of code.</p> <p>Furthermore, we showed how we could get rid of our validation function by defining a schema using the <code>Yup</code> library.</p> <p>Finally, we covered asynchronous validation and we discussed things to consider like when to validate and that it is probably best to have a field level validation for those few asynchronous fields that we have in a form and to use schema validation for the remaining fields.</p> <p>That's it, that was the end of our article. I hope this part and the previous one have given you new hope that dealing with Forms in React doesn't have to that painful</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/wunzt3wvfpyx1dk1lfz9.gif" alt=""></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1e960872.js" defer></script><script src="/assets/js/7.1b275639.js" defer></script><script src="/assets/js/6.6ae5d1ce.js" defer></script><script src="/assets/js/40.c814f3ec.js" defer></script>
  </body>
</html>
