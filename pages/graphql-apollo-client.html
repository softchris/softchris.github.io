<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Consuming an Apollo GraphQL Server using React</title>
    <meta name="description" content="[object Object]">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.32616fcf.css" as="style"><link rel="preload" href="/assets/js/app.b3d08b1f.js" as="script"><link rel="preload" href="/assets/js/9.454b5262.js" as="script"><link rel="preload" href="/assets/js/4.eac68367.js" as="script"><link rel="preload" href="/assets/js/130.5e5f2dad.js" as="script"><link rel="prefetch" href="/assets/js/1.36663999.js"><link rel="prefetch" href="/assets/js/10.c579e12d.js"><link rel="prefetch" href="/assets/js/100.3dc81b50.js"><link rel="prefetch" href="/assets/js/101.72742bb2.js"><link rel="prefetch" href="/assets/js/102.c5b6b37f.js"><link rel="prefetch" href="/assets/js/103.1820b033.js"><link rel="prefetch" href="/assets/js/104.eb93834d.js"><link rel="prefetch" href="/assets/js/105.85ce7f52.js"><link rel="prefetch" href="/assets/js/106.3c5e0dfc.js"><link rel="prefetch" href="/assets/js/107.93610e3a.js"><link rel="prefetch" href="/assets/js/108.649f86fc.js"><link rel="prefetch" href="/assets/js/109.1eea06b1.js"><link rel="prefetch" href="/assets/js/11.e44a9c79.js"><link rel="prefetch" href="/assets/js/110.aef9a48e.js"><link rel="prefetch" href="/assets/js/111.68a42b05.js"><link rel="prefetch" href="/assets/js/112.41c0d8e4.js"><link rel="prefetch" href="/assets/js/113.4d6c0e43.js"><link rel="prefetch" href="/assets/js/114.01233fba.js"><link rel="prefetch" href="/assets/js/115.58a117ca.js"><link rel="prefetch" href="/assets/js/116.31eb0de0.js"><link rel="prefetch" href="/assets/js/117.d93071ba.js"><link rel="prefetch" href="/assets/js/118.77fde6ba.js"><link rel="prefetch" href="/assets/js/119.d082b2b6.js"><link rel="prefetch" href="/assets/js/12.02e6e552.js"><link rel="prefetch" href="/assets/js/120.1eeaa590.js"><link rel="prefetch" href="/assets/js/121.0008565a.js"><link rel="prefetch" href="/assets/js/122.11adbe32.js"><link rel="prefetch" href="/assets/js/123.c0cc81ac.js"><link rel="prefetch" href="/assets/js/124.492211f9.js"><link rel="prefetch" href="/assets/js/125.a1d286cc.js"><link rel="prefetch" href="/assets/js/126.67d04a2e.js"><link rel="prefetch" href="/assets/js/127.946f0328.js"><link rel="prefetch" href="/assets/js/128.0163d3ea.js"><link rel="prefetch" href="/assets/js/129.c471fa72.js"><link rel="prefetch" href="/assets/js/13.215ad842.js"><link rel="prefetch" href="/assets/js/131.57c3edaa.js"><link rel="prefetch" href="/assets/js/132.733a653e.js"><link rel="prefetch" href="/assets/js/133.b3a6ace1.js"><link rel="prefetch" href="/assets/js/134.4875d74f.js"><link rel="prefetch" href="/assets/js/135.0d676867.js"><link rel="prefetch" href="/assets/js/136.8fa215a1.js"><link rel="prefetch" href="/assets/js/137.d1a37767.js"><link rel="prefetch" href="/assets/js/138.daf177ae.js"><link rel="prefetch" href="/assets/js/139.a9e6afdb.js"><link rel="prefetch" href="/assets/js/14.1a060010.js"><link rel="prefetch" href="/assets/js/140.7b6a9dc2.js"><link rel="prefetch" href="/assets/js/141.431d1d8f.js"><link rel="prefetch" href="/assets/js/142.03364e92.js"><link rel="prefetch" href="/assets/js/143.5140e806.js"><link rel="prefetch" href="/assets/js/144.610d3a75.js"><link rel="prefetch" href="/assets/js/145.7a02f27f.js"><link rel="prefetch" href="/assets/js/146.932455f9.js"><link rel="prefetch" href="/assets/js/147.4aa312fb.js"><link rel="prefetch" href="/assets/js/148.3a179c70.js"><link rel="prefetch" href="/assets/js/149.9cbc4fb4.js"><link rel="prefetch" href="/assets/js/15.34674cd6.js"><link rel="prefetch" href="/assets/js/150.22162903.js"><link rel="prefetch" href="/assets/js/151.289291bd.js"><link rel="prefetch" href="/assets/js/152.557c4f3c.js"><link rel="prefetch" href="/assets/js/153.074d34f1.js"><link rel="prefetch" href="/assets/js/154.9f1b9dfe.js"><link rel="prefetch" href="/assets/js/155.1e0f09ba.js"><link rel="prefetch" href="/assets/js/156.1f86486d.js"><link rel="prefetch" href="/assets/js/157.3d0cc8fc.js"><link rel="prefetch" href="/assets/js/158.229892f9.js"><link rel="prefetch" href="/assets/js/159.d8f4503c.js"><link rel="prefetch" href="/assets/js/16.651173ea.js"><link rel="prefetch" href="/assets/js/17.780050f1.js"><link rel="prefetch" href="/assets/js/18.31fbfd1d.js"><link rel="prefetch" href="/assets/js/19.910fc8d0.js"><link rel="prefetch" href="/assets/js/20.f2e93d17.js"><link rel="prefetch" href="/assets/js/21.8afea724.js"><link rel="prefetch" href="/assets/js/22.6ffcdce5.js"><link rel="prefetch" href="/assets/js/23.b53a4ebe.js"><link rel="prefetch" href="/assets/js/24.8940c321.js"><link rel="prefetch" href="/assets/js/25.b89393c2.js"><link rel="prefetch" href="/assets/js/26.e3067144.js"><link rel="prefetch" href="/assets/js/27.9214c9da.js"><link rel="prefetch" href="/assets/js/28.7a0f6ad5.js"><link rel="prefetch" href="/assets/js/29.2d61ba5c.js"><link rel="prefetch" href="/assets/js/3.970a66a4.js"><link rel="prefetch" href="/assets/js/30.b64b4f7c.js"><link rel="prefetch" href="/assets/js/31.1d52fcdf.js"><link rel="prefetch" href="/assets/js/32.2d0049bb.js"><link rel="prefetch" href="/assets/js/33.05b65ac5.js"><link rel="prefetch" href="/assets/js/34.e538e46b.js"><link rel="prefetch" href="/assets/js/35.4f5ca76f.js"><link rel="prefetch" href="/assets/js/36.b2037867.js"><link rel="prefetch" href="/assets/js/37.3c72162a.js"><link rel="prefetch" href="/assets/js/38.50de5acb.js"><link rel="prefetch" href="/assets/js/39.1d878b41.js"><link rel="prefetch" href="/assets/js/40.ab89e15b.js"><link rel="prefetch" href="/assets/js/41.a4d66623.js"><link rel="prefetch" href="/assets/js/42.5f225638.js"><link rel="prefetch" href="/assets/js/43.2208c523.js"><link rel="prefetch" href="/assets/js/44.be6612e4.js"><link rel="prefetch" href="/assets/js/45.8aa741b8.js"><link rel="prefetch" href="/assets/js/46.8ff3bd69.js"><link rel="prefetch" href="/assets/js/47.4fe07faf.js"><link rel="prefetch" href="/assets/js/48.9f02e5cb.js"><link rel="prefetch" href="/assets/js/49.698e3da5.js"><link rel="prefetch" href="/assets/js/5.d1da013e.js"><link rel="prefetch" href="/assets/js/50.535ea91c.js"><link rel="prefetch" href="/assets/js/51.1fcb3554.js"><link rel="prefetch" href="/assets/js/52.fc7407e8.js"><link rel="prefetch" href="/assets/js/53.9bcb2247.js"><link rel="prefetch" href="/assets/js/54.5469560c.js"><link rel="prefetch" href="/assets/js/55.ad7c79d3.js"><link rel="prefetch" href="/assets/js/56.4aeaa534.js"><link rel="prefetch" href="/assets/js/57.5355b3fb.js"><link rel="prefetch" href="/assets/js/58.f3c72a26.js"><link rel="prefetch" href="/assets/js/59.ce0b042e.js"><link rel="prefetch" href="/assets/js/6.9bdf2d86.js"><link rel="prefetch" href="/assets/js/60.d01a911c.js"><link rel="prefetch" href="/assets/js/61.34faf536.js"><link rel="prefetch" href="/assets/js/62.603ca7ac.js"><link rel="prefetch" href="/assets/js/63.bb5ee168.js"><link rel="prefetch" href="/assets/js/64.87766a1f.js"><link rel="prefetch" href="/assets/js/65.d6e07827.js"><link rel="prefetch" href="/assets/js/66.d8ba6fb6.js"><link rel="prefetch" href="/assets/js/67.0bdd4d2e.js"><link rel="prefetch" href="/assets/js/68.4c3afc1a.js"><link rel="prefetch" href="/assets/js/69.614262f5.js"><link rel="prefetch" href="/assets/js/7.9ac2367b.js"><link rel="prefetch" href="/assets/js/70.966d8650.js"><link rel="prefetch" href="/assets/js/71.34a6911b.js"><link rel="prefetch" href="/assets/js/72.05fca5e9.js"><link rel="prefetch" href="/assets/js/73.c26d8425.js"><link rel="prefetch" href="/assets/js/74.1e1a53c7.js"><link rel="prefetch" href="/assets/js/75.a786eaf6.js"><link rel="prefetch" href="/assets/js/76.dca03d61.js"><link rel="prefetch" href="/assets/js/77.af3ce1d2.js"><link rel="prefetch" href="/assets/js/78.f0ad3cac.js"><link rel="prefetch" href="/assets/js/79.7fea66bd.js"><link rel="prefetch" href="/assets/js/8.6b13a443.js"><link rel="prefetch" href="/assets/js/80.c2c37ed9.js"><link rel="prefetch" href="/assets/js/81.a6c06daa.js"><link rel="prefetch" href="/assets/js/82.e9069ad7.js"><link rel="prefetch" href="/assets/js/83.1ead38f3.js"><link rel="prefetch" href="/assets/js/84.319e8c88.js"><link rel="prefetch" href="/assets/js/85.9e65a216.js"><link rel="prefetch" href="/assets/js/86.efc7bce8.js"><link rel="prefetch" href="/assets/js/87.2a4c1c4d.js"><link rel="prefetch" href="/assets/js/88.bbd6d45d.js"><link rel="prefetch" href="/assets/js/89.5c66f752.js"><link rel="prefetch" href="/assets/js/90.230bb3c6.js"><link rel="prefetch" href="/assets/js/91.f4e3893f.js"><link rel="prefetch" href="/assets/js/92.a2448b1e.js"><link rel="prefetch" href="/assets/js/93.31960c6b.js"><link rel="prefetch" href="/assets/js/94.4f4eb673.js"><link rel="prefetch" href="/assets/js/95.05346d83.js"><link rel="prefetch" href="/assets/js/96.0cd0bc5e.js"><link rel="prefetch" href="/assets/js/97.aeb018d6.js"><link rel="prefetch" href="/assets/js/98.ea119b6b.js"><link rel="prefetch" href="/assets/js/99.c65ccf16.js">
    <link rel="stylesheet" href="/assets/css/0.styles.32616fcf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Consuming an Apollo GraphQL Server using React</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/graphql-apollo-client.html#set-up" class="sidebar-link">Set up</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/graphql-apollo-client.html#query" class="sidebar-link">Query</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/graphql-apollo-client.html#polling" class="sidebar-link">Polling</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/graphql-apollo-client.html#refetch" class="sidebar-link">Refetch</a></li></ul></li><li><a href="/pages/graphql-apollo-client.html#mutation" class="sidebar-link">Mutation</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/graphql-apollo-client.html#summary" class="sidebar-link">Summary</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="consuming-an-apollo-graphql-server-using-react"><a href="#consuming-an-apollo-graphql-server-using-react" aria-hidden="true" class="header-anchor">#</a> Consuming an Apollo GraphQL Server using React</h1> <p><img src="https://cdn-images-1.medium.com/max/1600/1*h-_NGiGhMwMHOPYU5Y8iFA.jpeg" alt=""></p> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p> <p>This article is part of series on Graphql</p> <ul><li><a href="https://dev.to/softchris/building-a-graphql-server-with-nodejs-andexpress-5hfh" target="_blank" rel="noopener noreferrer">Building a GraphQL server using Node.js and Express<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://dev.to/azure/creating-a-graphql-server-withapollo-jjj" target="_blank" rel="noopener noreferrer">Building a GraphQL server using Node.js and the Apollo Framework<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Consuming an Apollo GraphQL server using React, <strong>we are here</strong></li></ul> <blockquote><p>This is an introduction to how we can interact with an Apollo GraphQL server from the frontend. If you are not familiar with how to create and Apollo Server, have a look at this article first <a href="https://dev.to/azure/creating-a-graphql-server-withapollo-jjj" target="_blank" rel="noopener noreferrer">Creating an Apollo Server<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>In this article we will go through:</p> <ul><li><strong>set up</strong>, We need to specify the URL to our server and instantiate a client</li> <li><strong>query</strong>, There are Query components we can use to query for data</li> <li><strong>mutation</strong>, We can execute mutations using the Mutation component</li> <li><strong>polling/explicit</strong> <strong>fetch</strong>, Apollo comes with some nice functionality on polling, explicitly and fetching data</li></ul> <h2 id="set-up"><a href="#set-up" aria-hidden="true" class="header-anchor">#</a> <strong>Set up</strong></h2> <p>To set up a React app with GraphQL we need the libraries <code>apollo-boost</code> and <code>react-apollo</code>. <code>apollo-boost</code> provides us with <code>ApolloClient</code> that we need to instantiate given a <code>URL</code>. <code>react-apollo</code> gives us a <em>Higher Order</em> Provider <code>ApolloProvider</code> that we need to wrap our application with. First off do the necessary installs:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>yarn add react-apollo apollo-boost graphql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Once we’ve installed everything we are ready to set everything up. Head over to <code>index.js</code> and type the following:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ApolloClient <span class="token keyword">from</span> <span class="token string">&quot;apollo-boost&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloProvider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-apollo&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Local <span class="token keyword">from</span> “<span class="token punctuation">.</span><span class="token operator">/</span>components<span class="token operator">/</span>Local”<span class="token punctuation">;</span>

<span class="token keyword">const</span> localGraphQL <span class="token operator">=</span> <span class="token string">&quot;http://localhost:4000/graphql&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  uri<span class="token punctuation">:</span> localGraphQL
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ApolloProvider</span></span> <span class="token attr-name">client</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>client<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">My first Apollo app </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
     </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ApolloProvider</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>Above we are first instantiating <code>ApolloClient</code> and in the process providing it with a <code>url</code>, the location of our GraphQL server.</p> <p>Secondly, we are wrapping the entire application with our <code>ApolloProvider</code> and we also set its <code>client</code> property with our <code>ApolloClient</code> instance.</p> <p>Now we are ready to interact with our GraphQL server.</p> <h2 id="query"><a href="#query" aria-hidden="true" class="header-anchor">#</a> <strong>Query</strong></h2> <p>To be able to query an Apollo server we need to do three things:</p> <ul><li><strong>Write</strong> our <code>gql</code> query</li> <li><strong>Utilize</strong> the Query component the <code>react-apollo</code> library gives us</li> <li><strong>Render</strong> the response</li></ul> <p>To write our <code>gql</code> query we need to import <code>graphql-tag</code> and then write the GraphQL query, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> getRates <span class="token operator">=</span> gql<span class="token template-string"><span class="token string">`
{
  rates(currency: “USD”) {
    currency
    rate
  }
}`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Thereafter we need to import the <code>Query</code> component from <code>react-apollo</code> and as input property provide the query we just defined, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">Data</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>Query query<span class="token operator">=</span><span class="token punctuation">{</span>getRates<span class="token punctuation">}</span> <span class="token operator">&gt;</span>
  <span class="token comment">// render the query results</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Query<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>In the first child of our <code>Query</code> component we are invoking a function that has an object as a parameter. The object has the following properties:</p> <ul><li><strong>loading</strong>, as long as our query hasn’t resolved this is <code>true</code></li> <li><strong>error</strong>, if we get an error back from our query</li> <li><strong>data</strong>, the data result from our query</li></ul> <p>Now that we understand the properties and how we can use them, let’s put everything together:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Query <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-apollo&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> gql <span class="token keyword">from</span> <span class="token string">&quot;graphql-tag&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> getRates <span class="token operator">=</span> gql<span class="token template-string"><span class="token string">`
{
  products(type: &quot;DVD&quot;) {
    name
    price
  }
}`</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">Data</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Query</span></span> <span class="token attr-name">query</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>getRates<span class="token punctuation">}</span></span> <span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> loading<span class="token punctuation">,</span> error<span class="token punctuation">,</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>loading<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Loading…</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Error :(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> data<span class="token punctuation">.</span>products<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name<span class="token punctuation">,</span> price <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>price<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
   <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Query</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Data<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>We have now learned how we can read data from a GraphQL server and present into to our user.</p> <h2 id="polling"><a href="#polling" aria-hidden="true" class="header-anchor">#</a> <strong>Polling</strong></h2> <p>Not only do you want to fetch data but sometimes you also want to fetch data at a regular interval without explicitly navigating to a certain page or pressing a specific button for the GET request to be fired off. We use this in for example chat applications to achieve a sense of real-time. We are of course talking about polling, fetching data at a regular interval that we specify. The <code>Query</code> component that we learned to use has polling built in and all we need to do is to set a <code>pollInterval</code> property to the number of milliseconds we want between fetches. Let’s have a look at what that can look like:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Query <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-apollo&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> gql <span class="token keyword">from</span> <span class="token string">&quot;graphql-tag&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">GET_DATA</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token string">`
{
  products {
    name
    id
  }
}
`</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">DataPull</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Query</span></span> <span class="token attr-name">query</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token constant">GET_DATA</span><span class="token punctuation">}</span></span> <span class="token attr-name">pollInterval</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">500</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">loading<span class="token punctuation">,</span> error<span class="token punctuation">,</span> data<span class="token punctuation">,</span> startPolling<span class="token punctuation">,</span> stopPolling</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>loading<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`Error!: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>data<span class="token punctuation">.</span>products<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">p</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>p<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token function">startPolling</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Start polling</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">stopPolling</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Stop polling</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Query</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> DataPull<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>Above we have now introduced the following new concepts:</p> <ul><li><strong>pollInterval</strong>, this is something that expects polling interval in milliseconds, as you can see we set that to <code>500</code>, e.g half a second</li> <li><strong>startPolling</strong>, this is a function in which we can start the polling anew if we have previously stopped it</li> <li><strong>stopPolling</strong>, this is a function that allows us to stop the polling any time we want</li></ul> <h3 id="refetch"><a href="#refetch" aria-hidden="true" class="header-anchor">#</a> <strong>Refetch</strong></h3> <p>Sometimes we end up with scenarios where we want to explicitly fetch the data to ensure we are looking at the latest. The reason for doing so is to react to a user action rather than polling. Let’s look at how we can use this <code>refetch</code> functionality:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Query <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-apollo&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> gql <span class="token keyword">from</span> <span class="token string">&quot;graphql-tag&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">GET_DATA</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token string">`
{
  products {
    name
    id
  }
}
`</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">Refetch</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Query</span></span> <span class="token attr-name">query</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token constant">GET_DATA</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">loading<span class="token punctuation">,</span> error<span class="token punctuation">,</span> data<span class="token punctuation">,</span> refetch</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>loading<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`Error!: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>data<span class="token punctuation">.</span>prop<span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">refetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Fetch</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
   </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Query</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Refetch<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>Above we see that we have added another argument <code>refetch</code> to our <code>Query</code> child function like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{(loading, error, data, refetch) =&gt; {
}}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>This <code>refetch</code> argument is a function that we can invoke so we can, therefore, wire it up to a button in our markup like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;button onClick={() =&gt; refetch()}&gt;Fetch&lt;/button&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="mutation"><a href="#mutation" aria-hidden="true" class="header-anchor">#</a> <strong>Mutation</strong></h2> <p>When we do a mutation against a GraphQL server we need to do the following:</p> <ul><li><p><strong>invoke</strong> the correct mutation</p></li> <li><p><strong>use</strong> the Mutation component from <code>react-apollo</code></p></li></ul> <p>The above doesn’t sound like much and it isn’t. So let’s start with the first thing, our mutation query:</p> <p>We will be using the <code>gql</code> helper from the <code>graphql-tag</code> library to create our mutation query. Thereafter we use the keyword <code>mutation</code>, followed by giving the mutation a name and specify its input parameter <code>$person</code>. At this point we have the following query:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">ADD_PERSON</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token string">`
mutation AddPerson($person: Person!) {
}
`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Now we are ready to call the actual mutation <code>addPerson</code> that we defined in our GraphQL server. Your mutation query should now look like this:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">ADD_PERSON</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token string">`
  mutation AddPerson($person: Person!) {
    addPerson(person: $person) {
      id
    }
  }
`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Next up is putting the mutation query to use by working with our React component <code>Mutation</code>. The component will need two things:</p> <ul><li><strong>populate</strong> the <code>mutation</code> property,</li> <li><strong>define</strong> the child of the <code>Mutation</code> component, we will need to provide this with a function that as its first argument contain the <code>mutation</code> function that will trigger the mutation to happen and as the second argument it will take an object with the properties <code>data</code>, <code>error</code> and <code>loading</code></li></ul> <p>Let’s start with the first bit of using the <code>Mutation</code> component and set its <code>mutation</code> property, like so:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Mutation <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-apollo&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> gql <span class="token keyword">from</span> <span class="token string">&quot;graphql-tag&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">ADD_PERSON</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token string">`
  mutation AddPerson($person: Person!) {
    addPerson(person: $person) {
      id
    }
  }
`</span></span><span class="token punctuation">;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Mutation</span></span> <span class="token attr-name">mutation</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token constant">ADD_PERSON</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Mutation</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Above we have taken our <code>Mutation</code> component in use and set the <code>mutation</code> property with our mutation query <code>ADD_PERSON</code>. Next up is defining the child of the <code>Mutation</code> component. As we already stated that child is a function like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>(addPerson, { data, loading, error }) =&gt; (
// JSX
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>The function above is expected to return JSX. We are expected to define a piece of JSX that lets us use the following:</p> <ul><li><strong>addPerson()</strong>, this function that will carry out the mutation query.</li> <li><strong>loading</strong>, this boolean will tell us whether our mutation is ongoing or not, use this value to determine whether to use a spinner or not</li> <li><strong>data</strong>, this is the data that comes back after your mutation query finished</li></ul> <p>Now that we understand what the function parameters are for, let’s define our JSX. It is quite customary to define a Form when we want to collect data, so let’s do that:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;form onSubmit={e =&gt; {
  e.preventDefault();
  addPerson({ variables: { person: { name: input.value } } });
  input.value = “”;
}} &gt;
  &lt;input ref={node =&gt; { input = node; }} /&gt;
  &lt;button type=”submit”&gt;Add Person&lt;/button&gt;
  {loading &amp;&amp;
  &lt;div&gt;adding person…&lt;/div&gt;
  }
  { data &amp;&amp;
  &lt;div&gt;response data&lt;/div&gt;
  }
  { error &amp;&amp;
  &lt;div&gt;Error adding person…&lt;/div&gt;
  }
&lt;/form&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>As you can see above we have our Form and one input field and a button that we can press. We hook up the <code>addPerson()</code> method to the <code>onSubmit()</code> of the form. Note that we also solve how we get data to our mutation query. We give the <code>addPerson()</code> method an object that has a property <code>variables</code> in which we assign an object to the property <code>person</code>. That <code>person</code> property is the same input parameter that exist on our mutation query.</p> <p>The other fields <code>data</code>, <code>loading</code> and <code>error</code> are used as conditional JSX where we choose to show them if they are truthy.</p> <p>That’s it, that is all there is to it to invoke a mutation with some parameters and show the response, whether actual data or an error.</p> <p>Below is the entire code in its entirety.</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Mutation <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-apollo&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> gql <span class="token keyword">from</span> <span class="token string">&quot;graphql-tag&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">ADD_PERSON</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token string">`
  mutation AddPerson($person: Person!) {
    addPerson(person: $person) {
      id
    }
  }
`</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">DataInput</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> input<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Mutation</span></span> <span class="token attr-name">mutation</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token constant">ADD_PERSON</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">addPerson<span class="token punctuation">,</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> loading<span class="token punctuation">,</span> error <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      &lt;form onSubmit=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addPerson</span><span class="token punctuation">(</span><span class="token punctuation">{</span> variables<span class="token punctuation">:</span> <span class="token punctuation">{</span> person<span class="token punctuation">:</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> input<span class="token punctuation">.</span>value <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        input<span class="token punctuation">.</span>value <span class="token operator">=</span> “”<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text"> &gt;
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">node</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> input <span class="token operator">=</span> node<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span>”submit”</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Add Person</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>loading <span class="token operator">&amp;&amp;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">adding person…</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token punctuation">{</span> data <span class="token operator">&amp;&amp;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">response data</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token punctuation">{</span> error <span class="token operator">&amp;&amp;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Error adding person…</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Mutation</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> DataInput<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h2 id="summary"><a href="#summary" aria-hidden="true" class="header-anchor">#</a> <strong>Summary</strong></h2> <p>We have looked at different ways to interact with data from the backend.</p> <ul><li><p><strong>Fetching data</strong>, if we use the <code>Query</code> component we can fetch data by populating its <code>query</code> attribute with a <code>gql</code> question</p></li> <li><p><strong>Polling for data</strong>, if we set the attribute <code>pollInterval</code> on the <code>Query</code> component we can poll against our GraphQL backend.</p></li> <li><p><strong>Explicit data fetch</strong>, by using the extra argument <code>refetch</code>, we could explicitly fetch data when we wanted it</p></li> <li><p><strong>Triggering mutations</strong>, we learned that we could use the <code>Mutation</code> component to carry out mutations</p></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b3d08b1f.js" defer></script><script src="/assets/js/9.454b5262.js" defer></script><script src="/assets/js/4.eac68367.js" defer></script><script src="/assets/js/130.5e5f2dad.js" defer></script>
  </body>
</html>
