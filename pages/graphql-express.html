<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Building a GraphQL Server with Node.js and Express</title>
    <meta name="description" content="[object Object]">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.b1573886.css" as="style"><link rel="preload" href="/assets/js/app.6aa39101.js" as="script"><link rel="preload" href="/assets/js/9.454b5262.js" as="script"><link rel="preload" href="/assets/js/4.eac68367.js" as="script"><link rel="preload" href="/assets/js/136.09284adc.js" as="script"><link rel="prefetch" href="/assets/js/1.36663999.js"><link rel="prefetch" href="/assets/js/10.c579e12d.js"><link rel="prefetch" href="/assets/js/100.3dc81b50.js"><link rel="prefetch" href="/assets/js/101.40dbea08.js"><link rel="prefetch" href="/assets/js/102.d2f346e2.js"><link rel="prefetch" href="/assets/js/103.baf870fb.js"><link rel="prefetch" href="/assets/js/104.0928f9a8.js"><link rel="prefetch" href="/assets/js/105.85ce7f52.js"><link rel="prefetch" href="/assets/js/106.3c5e0dfc.js"><link rel="prefetch" href="/assets/js/107.93610e3a.js"><link rel="prefetch" href="/assets/js/108.a6a60bba.js"><link rel="prefetch" href="/assets/js/109.1b2b2d4a.js"><link rel="prefetch" href="/assets/js/11.e44a9c79.js"><link rel="prefetch" href="/assets/js/110.aef9a48e.js"><link rel="prefetch" href="/assets/js/111.68a42b05.js"><link rel="prefetch" href="/assets/js/112.cc6eb7bd.js"><link rel="prefetch" href="/assets/js/113.a73050b8.js"><link rel="prefetch" href="/assets/js/114.78be529f.js"><link rel="prefetch" href="/assets/js/115.3a5201b0.js"><link rel="prefetch" href="/assets/js/116.909a04a6.js"><link rel="prefetch" href="/assets/js/117.133cbbe4.js"><link rel="prefetch" href="/assets/js/118.a1a4fadb.js"><link rel="prefetch" href="/assets/js/119.2a0c1120.js"><link rel="prefetch" href="/assets/js/12.02e6e552.js"><link rel="prefetch" href="/assets/js/120.f31b1b5d.js"><link rel="prefetch" href="/assets/js/121.701589d8.js"><link rel="prefetch" href="/assets/js/122.e96b85f2.js"><link rel="prefetch" href="/assets/js/123.27970ec8.js"><link rel="prefetch" href="/assets/js/124.3a5b71a5.js"><link rel="prefetch" href="/assets/js/125.cf4856c9.js"><link rel="prefetch" href="/assets/js/126.d9b2dd4a.js"><link rel="prefetch" href="/assets/js/127.14d49f4d.js"><link rel="prefetch" href="/assets/js/128.5ac8370e.js"><link rel="prefetch" href="/assets/js/129.d55caec5.js"><link rel="prefetch" href="/assets/js/13.215ad842.js"><link rel="prefetch" href="/assets/js/130.d6bbfa29.js"><link rel="prefetch" href="/assets/js/131.dfb1592b.js"><link rel="prefetch" href="/assets/js/132.584a6556.js"><link rel="prefetch" href="/assets/js/133.ed9d9aea.js"><link rel="prefetch" href="/assets/js/134.0d6f2568.js"><link rel="prefetch" href="/assets/js/135.0bf20b5e.js"><link rel="prefetch" href="/assets/js/137.364fec81.js"><link rel="prefetch" href="/assets/js/138.2cba2435.js"><link rel="prefetch" href="/assets/js/139.240cca32.js"><link rel="prefetch" href="/assets/js/14.1a060010.js"><link rel="prefetch" href="/assets/js/140.417aa9e9.js"><link rel="prefetch" href="/assets/js/141.4c164491.js"><link rel="prefetch" href="/assets/js/142.3fb12322.js"><link rel="prefetch" href="/assets/js/143.5f2f03d7.js"><link rel="prefetch" href="/assets/js/144.372c8234.js"><link rel="prefetch" href="/assets/js/145.00717bb8.js"><link rel="prefetch" href="/assets/js/146.f3ffea81.js"><link rel="prefetch" href="/assets/js/147.06009ba5.js"><link rel="prefetch" href="/assets/js/148.bf590c16.js"><link rel="prefetch" href="/assets/js/149.d2a7e5e7.js"><link rel="prefetch" href="/assets/js/15.34674cd6.js"><link rel="prefetch" href="/assets/js/150.39ed521d.js"><link rel="prefetch" href="/assets/js/151.44cdb3b1.js"><link rel="prefetch" href="/assets/js/152.5e2943e5.js"><link rel="prefetch" href="/assets/js/153.1b906332.js"><link rel="prefetch" href="/assets/js/154.9c0eb5c6.js"><link rel="prefetch" href="/assets/js/155.b8f2e65a.js"><link rel="prefetch" href="/assets/js/156.c31ab506.js"><link rel="prefetch" href="/assets/js/157.38303cd4.js"><link rel="prefetch" href="/assets/js/158.cb0155c9.js"><link rel="prefetch" href="/assets/js/159.a6aefaa3.js"><link rel="prefetch" href="/assets/js/16.119e91d4.js"><link rel="prefetch" href="/assets/js/160.0e42bae7.js"><link rel="prefetch" href="/assets/js/161.4debf516.js"><link rel="prefetch" href="/assets/js/162.1d7d9107.js"><link rel="prefetch" href="/assets/js/163.d6461603.js"><link rel="prefetch" href="/assets/js/164.06b23ba7.js"><link rel="prefetch" href="/assets/js/165.cf7f0afc.js"><link rel="prefetch" href="/assets/js/166.fa7cb493.js"><link rel="prefetch" href="/assets/js/17.780050f1.js"><link rel="prefetch" href="/assets/js/18.a0340a5c.js"><link rel="prefetch" href="/assets/js/19.910fc8d0.js"><link rel="prefetch" href="/assets/js/20.f2e93d17.js"><link rel="prefetch" href="/assets/js/21.710dadb0.js"><link rel="prefetch" href="/assets/js/22.f4b7a74b.js"><link rel="prefetch" href="/assets/js/23.fa51555f.js"><link rel="prefetch" href="/assets/js/24.750257aa.js"><link rel="prefetch" href="/assets/js/25.b89393c2.js"><link rel="prefetch" href="/assets/js/26.e3067144.js"><link rel="prefetch" href="/assets/js/27.3ae67e52.js"><link rel="prefetch" href="/assets/js/28.ad131d60.js"><link rel="prefetch" href="/assets/js/29.2d61ba5c.js"><link rel="prefetch" href="/assets/js/3.970a66a4.js"><link rel="prefetch" href="/assets/js/30.b64b4f7c.js"><link rel="prefetch" href="/assets/js/31.1d52fcdf.js"><link rel="prefetch" href="/assets/js/32.3385e6c7.js"><link rel="prefetch" href="/assets/js/33.f2df8868.js"><link rel="prefetch" href="/assets/js/34.e538e46b.js"><link rel="prefetch" href="/assets/js/35.4f5ca76f.js"><link rel="prefetch" href="/assets/js/36.226d678a.js"><link rel="prefetch" href="/assets/js/37.0770aff2.js"><link rel="prefetch" href="/assets/js/38.50de5acb.js"><link rel="prefetch" href="/assets/js/39.1d878b41.js"><link rel="prefetch" href="/assets/js/40.ab89e15b.js"><link rel="prefetch" href="/assets/js/41.1bf4cba8.js"><link rel="prefetch" href="/assets/js/42.a77cd4e7.js"><link rel="prefetch" href="/assets/js/43.73aed762.js"><link rel="prefetch" href="/assets/js/44.be6612e4.js"><link rel="prefetch" href="/assets/js/45.f754d0bb.js"><link rel="prefetch" href="/assets/js/46.ce0b05f0.js"><link rel="prefetch" href="/assets/js/47.80468db8.js"><link rel="prefetch" href="/assets/js/48.3d301b11.js"><link rel="prefetch" href="/assets/js/49.913c3255.js"><link rel="prefetch" href="/assets/js/5.d1da013e.js"><link rel="prefetch" href="/assets/js/50.535ea91c.js"><link rel="prefetch" href="/assets/js/51.1fcb3554.js"><link rel="prefetch" href="/assets/js/52.fc7407e8.js"><link rel="prefetch" href="/assets/js/53.26a589ce.js"><link rel="prefetch" href="/assets/js/54.ecd8e917.js"><link rel="prefetch" href="/assets/js/55.097f7428.js"><link rel="prefetch" href="/assets/js/56.0055114e.js"><link rel="prefetch" href="/assets/js/57.5355b3fb.js"><link rel="prefetch" href="/assets/js/58.34ab508d.js"><link rel="prefetch" href="/assets/js/59.792d29bb.js"><link rel="prefetch" href="/assets/js/6.9bdf2d86.js"><link rel="prefetch" href="/assets/js/60.eadbd543.js"><link rel="prefetch" href="/assets/js/61.34faf536.js"><link rel="prefetch" href="/assets/js/62.603ca7ac.js"><link rel="prefetch" href="/assets/js/63.bb5ee168.js"><link rel="prefetch" href="/assets/js/64.87766a1f.js"><link rel="prefetch" href="/assets/js/65.d6e07827.js"><link rel="prefetch" href="/assets/js/66.d8ba6fb6.js"><link rel="prefetch" href="/assets/js/67.3cbc642b.js"><link rel="prefetch" href="/assets/js/68.6237b9d7.js"><link rel="prefetch" href="/assets/js/69.614262f5.js"><link rel="prefetch" href="/assets/js/7.9ac2367b.js"><link rel="prefetch" href="/assets/js/70.966d8650.js"><link rel="prefetch" href="/assets/js/71.34a6911b.js"><link rel="prefetch" href="/assets/js/72.7ff01b29.js"><link rel="prefetch" href="/assets/js/73.17c1d010.js"><link rel="prefetch" href="/assets/js/74.6c27ec85.js"><link rel="prefetch" href="/assets/js/75.a786eaf6.js"><link rel="prefetch" href="/assets/js/76.dca03d61.js"><link rel="prefetch" href="/assets/js/77.af3ce1d2.js"><link rel="prefetch" href="/assets/js/78.0c6f870f.js"><link rel="prefetch" href="/assets/js/79.a9fe7ec7.js"><link rel="prefetch" href="/assets/js/8.6b13a443.js"><link rel="prefetch" href="/assets/js/80.3c2be786.js"><link rel="prefetch" href="/assets/js/81.6f5c6378.js"><link rel="prefetch" href="/assets/js/82.e9069ad7.js"><link rel="prefetch" href="/assets/js/83.1c8923e0.js"><link rel="prefetch" href="/assets/js/84.08d63161.js"><link rel="prefetch" href="/assets/js/85.9e65a216.js"><link rel="prefetch" href="/assets/js/86.efc7bce8.js"><link rel="prefetch" href="/assets/js/87.2a4c1c4d.js"><link rel="prefetch" href="/assets/js/88.bbd6d45d.js"><link rel="prefetch" href="/assets/js/89.5bb2dd20.js"><link rel="prefetch" href="/assets/js/90.486983af.js"><link rel="prefetch" href="/assets/js/91.34533da6.js"><link rel="prefetch" href="/assets/js/92.d1b6b42b.js"><link rel="prefetch" href="/assets/js/93.31960c6b.js"><link rel="prefetch" href="/assets/js/94.4f4eb673.js"><link rel="prefetch" href="/assets/js/95.d4c791a6.js"><link rel="prefetch" href="/assets/js/96.e5129fbb.js"><link rel="prefetch" href="/assets/js/97.668b7326.js"><link rel="prefetch" href="/assets/js/98.ea119b6b.js"><link rel="prefetch" href="/assets/js/99.c65ccf16.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b1573886.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Building a GraphQL Server with Node.js and Express</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/graphql-express.html#why-graphql" class="sidebar-link">Why GraphQL</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/graphql-express.html#building-blocks" class="sidebar-link">Building blocks</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/graphql-express.html#install-dependencies" class="sidebar-link">Install dependencies</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/graphql-express.html#express-graphql-only" class="sidebar-link">Express + graphql (only)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/graphql-express.html#adding-express-graphql" class="sidebar-link">Adding express-graphql</a></li><li class="sidebar-sub-header"><a href="/pages/graphql-express.html#graphiql" class="sidebar-link">Graphiql</a></li><li class="sidebar-sub-header"><a href="/pages/graphql-express.html#parameterized-query" class="sidebar-link">Parameterized query</a></li></ul></li><li><a href="/pages/graphql-express.html#summary" class="sidebar-link">Summary</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="building-a-graphql-server-with-node-js-and-express"><a href="#building-a-graphql-server-with-node-js-and-express" aria-hidden="true" class="header-anchor">#</a> Building a GraphQL Server with Node.js and Express</h1> <p><img src="https://cdn-images-1.medium.com/max/1600/1*a4sGHbJDDttlJI3xWg-28w.jpeg" alt=""></p> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p> <p>This article is part of a series on GraphQL:</p> <ul><li>Building a GraphQL server using Node.js and Express, <strong>we are here</strong></li> <li><a href="https://dev.to/azure/creating-a-graphql-server-withapollo-jjj" target="_blank" rel="noopener noreferrer">Building a GraphQL server using Node.js and the Apollo Framework<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://dev.to/softchris/consuming-an-apollo-graphql-server-usingreact-3kk4" target="_blank" rel="noopener noreferrer">Consuming an Apollo GraphQL server using React<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <blockquote><p>GraphQL enables us to build a server that a client can query in any way they want. I’m of course talking about content negotiation, the ability to ask the server exactly for the fields or resources they want, at any depth.</p></blockquote> <p>In a previous article <a href="https://medium.com/@noringc/building-your-first-graphql-server-d5c4f88f5e82" target="_blank" rel="noopener noreferrer">Building your first GraphQL Server<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, I’ve covered what different artifacts and types that make out a GraphQL server. In this article, we will focus more on how to build a service, powered by GraphQL that clients can consume. We will also introduce a playground environment called GraphiQL that gives us a UI in which we can test our queries out.</p> <p>In this article we will cover:</p> <ul><li><strong>why Graphql</strong>, Graphql is a nice new technology let's try to cover why it's relevant and why it will make building APIs fun and easy</li> <li><strong>building blocks</strong>, let's go through the building blocks that you need to build the server side of Graphql</li> <li><strong>building a server</strong>, we will use Node.js, Express, amd a library called express-graphql to make it possible</li> <li><strong>querying</strong>, we will cover different ways of querying our server like normal queries, paramterized queries and also how to change data with mutations</li></ul> <h2 id="why-graphql"><a href="#why-graphql" aria-hidden="true" class="header-anchor">#</a> Why GraphQL</h2> <p>There are many reasons for choosing GraphQL over REST:</p> <ul><li><strong>the data you need</strong>, As with all techniques using content negotiation you get the ability to query for just the data you need that means you get exactly the columns you ask for and that keeps the returning answer to a minimum. Especially in todays world with mobile first and 3G/4G connections, keeping the data responses to a minimum in size is a really great thing.</li> <li><strong>one endpoint</strong>, as soon as you want data specific data from an endpoint you query that specific endpoint. What if the data you need is something you need to puzzle together from more than one endpoint? At that point, you carry out a bunch of calls or build a new endpoint. Regardless of approach you choose, you need to spend time managing and knowing your endpoints. GraphQL shines here as it is just one endpoint.</li> <li><strong>serialization</strong>, when you call a REST you get the response JSON you get. However, you might need to do some extra <em>massage</em> to your data like renaming columns, for example, to better suit your application. With GraphQL you can specify this in the query itself</li> <li><strong>go at depth</strong>, normally with REST it's easy a specific thing like an Order. What if you wanted to fetch the Order Items on that Order or even the Products the Customer bough? Most likely you would have to make several calls or make a specific reporting query for this to avoid extra roundtrips. With GraphQL you can query as deep as you need in the Graph and bring out the data you need at any depth. Of course, doing this in an efficient way is one of the bigger challenges with GraphQL, it's not all sunshine and roses. GraphQL is not a silver bullet but it makes life a lot easier</li></ul> <h2 id="building-blocks"><a href="#building-blocks" aria-hidden="true" class="header-anchor">#</a> Building blocks</h2> <p>A GraphQL Server consists of the following:</p> <ul><li><strong>a schema</strong>, the schema defines our entities but also what we can query or call a mutation on</li> <li><strong>resolvers</strong>, resolver functions talks to a 3rd party API or our database and ends up returning data back to our user</li></ul> <h2 id="install-dependencies"><a href="#install-dependencies" aria-hidden="true" class="header-anchor">#</a> Install dependencies</h2> <p>Let’s start off by installing our needed dependencies. We need the following:</p> <ul><li><strong>express</strong>, to create our web server</li> <li><strong>graphql</strong>, to install graphql, our core lib that enables us to leverage graphql</li> <li><strong>express-graphql</strong>, this library enables us to bind together graphql and express</li></ul> <h2 id="express-graphql-only"><a href="#express-graphql-only" aria-hidden="true" class="header-anchor">#</a> Express + graphql (only)</h2> <p>Let’s start off by only installing <code>graphql</code> and <code>express</code> to understand what that gives us:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install express graphql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Thereafter let’s create an <code>express</code> HTTP server, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// schema.mjs</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span>
  graphql<span class="token punctuation">,</span>
  GraphQLSchema<span class="token punctuation">,</span>
  GraphQLObjectType<span class="token punctuation">,</span>
  GraphQLString<span class="token punctuation">,</span>
  GraphQLList
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;graphql&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> humanType <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GraphQLObjectType</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">&quot;Human&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fields</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    id<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> GraphQLString <span class="token punctuation">}</span><span class="token punctuation">,</span>
    description<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> GraphQLString <span class="token punctuation">}</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> GraphQLString <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> people <span class="token keyword">from</span> <span class="token string">&quot;./data/people&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> schema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GraphQLSchema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  query<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">GraphQLObjectType</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">&quot;RootQueryType&quot;</span><span class="token punctuation">,</span>
  fields<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    hello<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> GraphQLString<span class="token punctuation">,</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    person<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> humanType<span class="token punctuation">,</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    people<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">GraphQLList</span><span class="token punctuation">(</span>humanType<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> people<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> graphql <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> schema<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p>This is a pretty simple schema that declares <code>hello</code>, <code>person</code> and <code>people</code> as queryable keywords and it also creates <code>humanType</code> as a custom type.</p> <p>A short comment on the file ending <code>.mjs</code>. What we are doing here is to leverage experimental support for <code>ESM/EcmaScript</code> modules. The way they are currently implemented in NodeJS forces us to have a file ending of <code>.mjs</code>.</p> <p>Next up is the app itself that is just a basic express application looking like this:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
<span class="token comment">// app.mjs</span>
<span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">&quot;express&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">3000</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> schema<span class="token punctuation">,</span> <span class="token punctuation">{</span> graphql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./schema&quot;</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> query <span class="token operator">=</span> <span class="token template-string"><span class="token string">`{ hello, person { name }, people { name, description } }`</span></span><span class="token punctuation">;</span>
  <span class="token function">graphql</span><span class="token punctuation">(</span>schema<span class="token punctuation">,</span> query<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Example app listening on port port!`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Above we are declaring a default route by calling:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Then we add the <code>graphql</code> part by invoking it with parameters <code>schema</code> and <code>query</code>, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">graphql</span><span class="token punctuation">(</span>schema<span class="token punctuation">,</span> query<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>As we can see above invoking <code>graphql</code> means we get a promise back and on the <code>then()</code> callback we are able to see the result from our query. All together we can see how <code>graphql</code> and <code>express</code> can interact.</p> <p>Lastly, to run this we need to specify a <code>start</code> command in our <code>package.json</code> file that invokes the experimental support for ESM modules. It needs to look like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>// excerpt from package.json
&quot;start&quot;: &quot;node — experimental-modules app.mjs&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="adding-express-graphql"><a href="#adding-express-graphql" aria-hidden="true" class="header-anchor">#</a> Adding express-graphql</h3> <p>We just showed how we can use <code>express</code> and <code>graphql</code> and create a REST api, but we can do this better by adding <code>express-graphql</code>, so let’s do that as our next thing:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install express-graphql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Let’s do something else first, for ourselves, namely, use the <code>buildSchema()</code> method and set up a schema that way, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token punctuation">{</span> buildSchema <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;graphql&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> schema <span class="token operator">=</span> <span class="token function">buildSchema</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`
  type Product {
    name: String,
    id: Int
  },
  type Query {
    hello: String,
    products: [Product]
  }
`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>Above we can see that we define the custom type <code>Product</code> and we also define our queries being <code>hello</code> and <code>products</code>.</p> <p>We also need some resolver functions with that which we define next:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">getProducts</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> <span class="token string">'Movie'</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>  

<span class="token keyword">var</span> root <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">hello</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello world!&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">products</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">getProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Lastly, we are able to clean up our code a bit so our code for starting our server looks like this now:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> graphqlHTTP <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express-graphql&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token string">'/graphql'</span><span class="token punctuation">,</span>
  <span class="token function">graphqlHTTP</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    schema<span class="token punctuation">:</span> schema<span class="token punctuation">,</span>
    rootValue<span class="token punctuation">:</span> root<span class="token punctuation">,</span>
    graphiql<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>That’s it, we don’t actually need to define any routes but we leave that up to graphql. We can see that <code>graphqlHTTP()</code> is a function that we get from <code>express-graphql</code></p> <p>Now we have all the bits in place.</p> <h3 id="graphiql"><a href="#graphiql" aria-hidden="true" class="header-anchor">#</a> <strong>Graphiql</strong></h3> <p>When we called our <code>graphqlHTTP()</code> function we provided it with a configuration object that had the following properties set:</p> <ul><li><strong>schema</strong>, our GraphQL schema</li> <li><strong>rootValue</strong>, our resolver functions</li> <li><strong>graphiql</strong>, a boolean stating whether to use <code>graphiql</code>, we want that so we pass <code>true</code> here</li></ul> <p>Next step is to try out <code>graphiql</code> which we do by navigating to <code>http://localhost:4000/graphql</code> and voila, this is what you should be seeing:</p> <p><img src="https://cdn-images-1.medium.com/max/1600/1*X8nQBrmfPu4nmbzPjUNGhA.png" alt=""></p> <p>Ok great, a visual interface, now what?</p> <p>Well, now you can start creating Graphql queries. To know what to query for, have a look at what you defined in the schema.</p> <p>We expect that we will be able to query for <code>hello</code> and <code>products</code> as we set those up in our schema. So let’s do that:</p> <p><img src="https://cdn-images-1.medium.com/max/1600/1*X_D6Hbp9JO71SHea0M03fQ.png" alt=""></p> <p>Ok then, you should be seeing the above by hitting the <code>play</code> icon. As you can see this is a very useful tool to debug your queries but it can also be used to debug your mutations.</p> <h3 id="parameterized-query"><a href="#parameterized-query" aria-hidden="true" class="header-anchor">#</a> Parameterized query</h3> <p>Let’s try to write a query with parameters in graphiql:</p> <p><img src="https://cdn-images-1.medium.com/max/1600/1*eD5LVw96Aq9kmzaser0yMg.png" alt=""></p> <p>Above we can see how we define our query by using the keyword <code>query</code>. Thereafter we give it a name <code>Query</code> followed by a parenthesis. Within the parenthesis, we have the input parameter that we denote with <code>$</code> character. In this case, we call our parameter <code>id</code>, which means its full name is <code>$id</code>. Let’s look at what we got:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>query <span class="token function">Query</span><span class="token punctuation">(</span><span class="token parameter">$id<span class="token punctuation">:</span> Int<span class="token operator">!</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// our actual query</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Now it’s time to write our actual query, so let’s do that next:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">product</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">:</span> $id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  name
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>As you can see we use the <code>$id</code> from our query construction and the full result looks like this:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>query <span class="token function">Query</span><span class="token punctuation">(</span><span class="token parameter">$id<span class="token punctuation">:</span> Int<span class="token operator">!</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">product</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">:</span> $id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    name
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>NOTE: at the bottom of the screen we have a section called <code>query variables</code> that lets us define variables we want to use as input. So when we define something as <code>$name_of_variable</code> it will look into the <code>query variables</code> section</p></blockquote> <p><strong>calling a Mutation</strong></p> <p>To invoke a mutation we need the <code>mutation</code> keyword. Let’s create our mutation invocation next:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>mutation MyMutation <span class="token punctuation">{</span>
  <span class="token function">addProduct</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">&quot;product&quot;</span><span class="token punctuation">,</span> description<span class="token punctuation">:</span> <span class="token string">&quot;description of a product&quot;</span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>NOTE: if we return a complex object we need to select what columns we want, like so</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>mutation MyMutation {
  addProduct(name: &quot;product&quot;, description: &quot;description of a product&quot;){ 
    col1, 
    col2 
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="summary"><a href="#summary" aria-hidden="true" class="header-anchor">#</a> Summary</h2> <p>To build an API we have used the NPM libraries <code>express</code>, <code>graphql</code>. However, by adding <code>express-graphql</code> we have gained access to a visual environment called <code>graphiql</code> that enables us to pose queries and run mutations so we can verify that our API works as intended</p> <p>If you want to look at an existing repo, have a look here <a href="https://github.com/softchris/graphql-graphiql" target="_blank" rel="noopener noreferrer">Demo repo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.6aa39101.js" defer></script><script src="/assets/js/9.454b5262.js" defer></script><script src="/assets/js/4.eac68367.js" defer></script><script src="/assets/js/136.09284adc.js" defer></script>
  </body>
</html>
